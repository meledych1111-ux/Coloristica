<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Colorictica | –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è</title>
    
    <!-- PWA –º–µ—Ç–∞-—Ç–µ–≥–∏ -->
    <meta name="application-name" content="Colorictica">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Colorictica">
    <meta name="description" content="–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è –≤–æ–ª–æ—Å">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#4a148c">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="theme-color" content="#4a148c">

    <!-- –ú–∞–Ω–∏—Ñ–µ—Å—Ç PWA -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="apple-touch-icon" href="icon.png">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #2c3e50;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #4a148c 0%, #6a1b9a 100%);
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(74, 20, 140, 0.2);
            color: white;
            flex-shrink: 0;
            position: relative;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
        }

        .online-status {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            color: white;
            display: none;
        }

        .online-status.online {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            display: block;
        }

        .online-status.offline {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            display: block;
        }

        .install-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 8px 16px;
            background: linear-gradient(135deg, #ff5722 0%, #ff7043 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.85rem;
            display: none;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π layout */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 20px;
            flex: 1;
            min-height: 0;
            overflow: hidden;
        }

        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
                overflow-y: auto;
            }
        }

        /* –ü–∞–Ω–µ–ª—å –≤—ã–±–æ—Ä–∞ */
        .selection-panel {
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .selection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
            flex-shrink: 0;
        }

        .selected-display {
            text-align: center;
            flex: 1;
        }

        .selected-code {
            font-size: 3rem;
            font-weight: 900;
            color: #4a148c;
            margin-bottom: 5px;
        }

        .selected-name {
            font-size: 1.2rem;
            color: #ff5722;
            font-weight: 600;
        }

        /* –ê–≤—Ç–æ–ø–∞–ª–∏—Ç—Ä—ã - –ü–ï–†–ï–ú–ï–©–ï–ù–´ –í–í–ï–†–• */
        .auto-palettes {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 25px;
            flex-shrink: 0;
        }

        .palette-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }

        .palette-card:hover {
            border-color: #4a148c;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(74, 20, 140, 0.15);
        }

        .palette-color {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid #f0f0f0;
            margin: 0 auto 10px;
            transition: all 0.3s ease;
        }

        .palette-card:hover .palette-color {
            border-color: #4a148c;
            transform: scale(1.1);
        }

        .palette-code {
            font-weight: 800;
            color: #4a148c;
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .palette-name {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }

        /* –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä */
        .quick-select {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .quick-btn {
            padding: 10px 15px;
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: #4a148c;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .quick-btn:hover {
            border-color: #4a148c;
            background: #f3e5f5;
        }

        /* –ö—Ä—É–≥–∏ –≤—ã–±–æ—Ä–∞ */
        .selection-circles {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
            flex: 1;
            min-height: 0;
            align-items: center;
        }

        .circle-container {
            text-align: center;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .circle-label {
            color: #4a148c;
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .color-circle {
            width: 280px;
            height: 280px;
            margin: auto;
            position: relative;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 0 0 10px white, 0 0 0 12px #eee;
            flex-shrink: 0;
        }

        /* –°–µ–≥–º–µ–Ω—Ç—ã –∫—Ä—É–≥–∞ */
        .segment {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: 100% 100%;
            left: 0;
            top: 0;
            cursor: pointer;
            clip-path: polygon(0 0, 100% 100%, 0 100%);
        }

        .segment:hover {
            filter: brightness(1.1);
        }

        .segment.selected {
            box-shadow: inset 0 0 0 5px white, inset 0 0 0 7px #ff5722;
            z-index: 10;
        }

        .segment.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            filter: grayscale(0.8);
        }

        /* –¶–∏—Ñ—Ä—ã –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç–∞—Ö - –ë–ï–õ–´–ï –° –ß–ï–†–ù–û–ô –†–ê–ú–ö–û–ô */
        .segment-number {
            position: absolute;
            font-weight: 900;
            font-size: 1.8rem;
            pointer-events: none;
            z-index: 20;
            color: #ffffff;
            text-shadow: 
                -1px -1px 0 #000000,
                1px -1px 0 #000000,
                -1px 1px 0 #000000,
                1px 1px 0 #000000,
                0 -1px 0 #000000,
                0 1px 0 #000000,
                -1px 0 0 #000000,
                1px 0 0 #000000,
                0 0 3px #000000;
            -webkit-text-stroke: 1px #000000;
            left: 33%;
            top: 67%;
            transform: translate(-50%, -50%);
            will-change: transform;
        }

        /* –¶–≤–µ—Ç–∞ —É—Ä–æ–≤–Ω–µ–π –≥–ª—É–±–∏–Ω—ã */
        .depth-1 { background: #000000; }
        .depth-2 { background: #2C1810; }
        .depth-3 { background: #422A1A; }
        .depth-4 { background: #5C3A22; }
        .depth-5 { background: #7A4F2E; }
        .depth-6 { background: #9C6D3C; }
        .depth-7 { background: #BD8B4A; }
        .depth-8 { background: #D8A85C; }
        .depth-9 { background: #F0C67A; }
        .depth-10 { background: #FFE1A3; }

        /* –¶–≤–µ—Ç–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π */
        .tone-0 { background: #D1BCA4; }
.tone-1 { background: #B0C0C0; }
.tone-2 { background: #EEE6D5; }
.tone-3 { background: #E5BF65; }
.tone-4 { background: #C06835; }
.tone-5 { background: #D6B595; }
.tone-6 { background: #982845; }
.tone-7 { background: #773F2A; }
.tone-8 { background: #E59035; }
.tone-9 { background: #D55825; }
.tone-10 { background: #885088; }
.tone-11 { background: #A080A0; }
.tone-12 { background: #385688; }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å */
        .info-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
            min-height: 0;
            overflow-y: auto;
            height: 100%;
        }

        .info-card {
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
            flex-shrink: 0;
        }

        .info-card h3 {
            color: #4a148c;
            margin-bottom: 15px;
            font-size: 1.2rem;
            border-bottom: 3px solid #ff5722;
            padding-bottom: 10px;
        }

        /* –ë–ª–æ–∫ —Å –æ—à–∏–±–∫–æ–π */
        .error-container {
            display: none;
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            border: 2px solid #ef5350;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            color: #c62828;
        }

        .error-container.show {
            display: block;
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ü–≤–µ—Ç–µ */
        .color-info-container {
            min-height: 200px;
        }

        /* –ë–ª–æ–∫ —Å —Ü–≤–µ—Ç–æ–º */
        .color-recipe {
            background: white;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 8px solid #4a148c;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        /* –°–µ–∫—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ */
        .info-section {
            margin-bottom: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 1px solid #e9ecef;
        }

        .info-section.highlight {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            padding: 20px;
            border-radius: 12px;
            border-left: 6px solid #ff9800;
            margin: 20px 0;
            border: 1px solid #ffcc80;
        }

        .section-title {
            font-weight: 700;
            color: #4a148c;
            margin-bottom: 15px;
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px dashed #dee2e6;
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 600;
            color: #555;
            flex: 1;
        }

        .info-value {
            font-weight: 700;
            color: #ff5722;
            flex: 1;
            text-align: right;
            font-size: 1.1rem;
        }

        /* –ë–ª–æ–∫ —Ä–µ—Ü–µ–ø—Ç–∞ */
        .recipe-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .recipe-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            text-align: center;
        }

        .recipe-amount {
            font-weight: 800;
            color: #4a148c;
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .recipe-name {
            font-size: 0.9rem;
            color: #666;
        }

        /* –ë—ã—Å—Ç—Ä–∞—è –ø–∞–ª–∏—Ç—Ä–∞ - –£–î–ê–õ–ï–ù–û, –ü–ï–†–ï–ú–ï–©–ï–ù–û –í–í–ï–†–• */

        /* –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã */
        .tools-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-top: 15px;
        }

        .tool-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .tool-card:hover {
            border-color: #4a148c;
            background: #f3e5f5;
        }

        .tool-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #4a148c 0%, #6a1b9a 100%);
            color: white;
            border-radius: 8px;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .tool-content {
            flex: 1;
        }

        .tool-title {
            font-weight: 700;
            color: #4a148c;
            margin-bottom: 3px;
            font-size: 1rem;
        }

        .tool-description {
            color: #666;
            font-size: 0.85rem;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 0;
            width: 90%;
            max-width: 900px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            padding: 20px;
            background: linear-gradient(135deg, #4a148c 0%, #6a1b9a 100%);
            color: white;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .close {
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            opacity: 0.8;
        }

        .close:hover {
            opacity: 1;
            color: #ffcc80;
        }

        .modal-body {
            padding: 20px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .modal-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #ff5722;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1200px) {
            .selection-circles {
                flex-direction: column;
                align-items: center;
            }
        }

        @media (max-width: 768px) {
            body {
                position: relative;
                overflow: auto;
                height: auto;
            }
            
            .container {
                height: auto;
            }
            
            .main-grid {
                overflow: visible;
            }
            
            .info-panel {
                overflow: visible;
            }
            
            header {
                padding: 15px;
                margin-bottom: 15px;
            }
            
            h1 {
                font-size: 1.6rem;
            }
            
            .selected-code {
                font-size: 2.5rem;
            }
            
            .quick-select {
                justify-content: center;
            }
            
            .quick-btn {
                padding: 8px 12px;
                font-size: 0.85rem;
            }
            
            .auto-palettes {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .palette-card {
                padding: 12px;
            }
            
            .palette-color {
                width: 35px;
                height: 35px;
            }
            
            .palette-code {
                font-size: 1.1rem;
            }
            
            .color-circle {
                width: 240px;
                height: 240px;
            }
            
            .segment-number {
                font-size: 1.5rem;
            }
            
            .tool-card {
                padding: 12px;
                gap: 12px;
            }
            
            .tool-icon {
                width: 35px;
                height: 35px;
                font-size: 1.1rem;
            }
            
            .recipe-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .auto-palettes {
                grid-template-columns: 1fr;
            }
            
            .color-circle {
                width: 220px;
                height: 220px;
            }
            
            .segment-number {
                font-size: 1.3rem;
            }
            
            .selection-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .info-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .info-value {
                text-align: left;
                font-size: 1rem;
            }
            
            .tool-card {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }
            
            .recipe-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div id="online-status" class="online-status">–û–Ω–ª–∞–π–Ω</div>
            <button id="installButton" class="install-btn">üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
            
            <h1>üé® –ö–æ–ª–æ—Ä–∏—Å—Ç–∏–∫–∞</h1>
            <p class="subtitle">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è –≤–æ–ª–æ—Å</p>
        </header>

        <div class="main-grid">
            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
            <div class="selection-panel">
    <div class="selection-header">
        <div class="selected-display">
            <div class="selected-code" id="selectedColorCode">-.-</div>
            <div class="selected-name" id="selectedColorName">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –∏ —Ç–æ–Ω</div>
        </div>
        <div class="quick-select">
    <button class="quick-btn" onclick="selectExample(10, 1)">10.1</button>
    <button class="quick-btn" onclick="selectExample(9, 3)">9.3</button>
    <button class="quick-btn" onclick="selectExample(8, 1)">8.1</button>
    <button class="quick-btn" onclick="selectExample(8, 11)">8.11</button>
    <button class="quick-btn" onclick="selectExample(7, 11)">7.11</button>
    <button class="quick-btn" onclick="selectExample(9, 11)">9.11</button>
    <button class="quick-btn" onclick="selectExample(6, 4)">6.4</button>
    <button class="quick-btn" onclick="selectExample(5, 7)">5.7</button>
</div>
    </div>
                <!-- –ö—Ä—É–≥–∏ –≤—ã–±–æ—Ä–∞ -->
                <div class="selection-circles">
                    <div class="circle-container">
                        <div class="circle-label">–£—Ä–æ–≤–µ–Ω—å –≥–ª—É–±–∏–Ω—ã —Ç–æ–Ω–∞</div>
                        <div class="color-circle depth-circle" id="depthCircle"></div>
                    </div>
                    
                    <div class="circle-container">
                        <div class="circle-label">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞</div>
                        <div class="color-circle tone-circle" id="toneCircle"></div>
                    </div>
                </div>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
<div class="info-panel">
    <div class="info-card">
        <h3>üé® –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –¶–í–ï–¢–ï</h3>
        
        <div id="errorContainer" class="error-container">
            <strong>‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è!</strong>
            <p id="errorMessage"></p>
        </div>
        
        <div id="colorInfoContainer" class="color-info-container">
            <div class="color-recipe">
                <p>–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –≥–ª—É–±–∏–Ω—ã –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞</p>
            </div>
        </div>
    </div>

    <div class="info-card">
        <h3>üõ†Ô∏è –ò–ù–°–¢–†–£–ú–ï–ù–¢–´</h3>
        
        <div class="tools-grid">
            <div class="tool-card" onclick="showCorrectorTable()">
                <div class="tool-icon">üé®</div>
                <div class="tool-content">
                    <div class="tool-title">–¢–∞–±–ª–∏—Ü–∞ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–æ–≤</div>
                    <div class="tool-description">–í—Å–µ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä—ã –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã</div>
                </div>
            </div>
            
            <div class="tool-card" onclick="showColorTables()">
                <div class="tool-icon">üåà</div>
                <div class="tool-content">
                    <div class="tool-title">–¢–∞–±–ª–∏—Ü—ã —Ü–≤–µ—Ç–æ–≤</div>
                    <div class="tool-description">–£—Ä–æ–≤–Ω–∏ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>
                </div>
            </div>
            
            <div class="tool-card" onclick="showMixingCalculator()">
                <div class="tool-icon">üßÆ</div>
                <div class="tool-content">
                    <div class="tool-title">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å–º–µ—à–∏–≤–∞–Ω–∏—è</div>
                    <div class="tool-description">–†–∞—Å—á–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–π</div>
                </div>
            </div>
            
            <!-- –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê: –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–µ—Ä–µ—Ö–æ–¥–∞ —É—Ä–æ–≤–Ω–µ–π -->
            <div class="tool-card" onclick="showLevelTransitionCalculator()">
                <div class="tool-icon">üìà</div>
                <div class="tool-content">
                    <div class="tool-title">–ü–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏</div>
                    <div class="tool-description">–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ/–∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ</div>
                </div>
            </div>
            
            <!-- –ù–û–í–´–ô: –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–æ–º -->
            <div class="tool-card" onclick="showCorrectorMixCalculator()">
                <div class="tool-icon">‚öóÔ∏è</div>
                <div class="tool-content">
                    <div class="tool-title">–°–º–µ—à–∏–≤–∞–Ω–∏–µ —Å –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–æ–º</div>
                    <div class="tool-description">–ú–∏–∫—Å—Ç–æ–Ω vs –ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä</div>
                </div>
            </div>
            
            <div class="tool-card" onclick="showHairDiagnostics()">
                <div class="tool-icon">üîç</div>
                <div class="tool-content">
                    <div class="tool-title">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤–æ–ª–æ—Å</div>
                    <div class="tool-description">–ü–æ—Ä–∏—Å—Ç–æ—Å—Ç—å –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</div>
                </div>
            </div>
            
            <div class="tool-card" onclick="showLighteningGuide()">
                <div class="tool-icon">‚ö°</div>
                <div class="tool-content">
                    <div class="tool-title">–ì–∏–¥ –ø–æ –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—é</div>
                    <div class="tool-description">–§–æ–Ω—ã –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è</div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
        // ============================================
        // –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–ê–Ø –õ–û–ì–ò–ö–ê –ö–û–õ–û–†–ò–°–¢–ò–ö–ò
        // ============================================

        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤
        const depthData = {
            1: { name: "–ß–µ—Ä–Ω—ã–π", color: "#000000" },
            2: { name: "–¢–µ–º–Ω–æ-–∫–æ—Ä–∏—á–Ω–µ–≤—ã–π", color: "#2C1810" },
            3: { name: "–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π", color: "#422A1A" },
            4: { name: "–¢–µ–º–Ω—ã–π —à–∞—Ç–µ–Ω", color: "#5C3A22" },
            5: { name: "–®–∞—Ç–µ–Ω", color: "#7A4F2E" },
            6: { name: "–†—É—Å—ã–π", color: "#9C6D3C" },
            7: { name: "–°–≤–µ—Ç–ª—ã–π —Ä—É—Å—ã–π", color: "#BD8B4A" },
            8: { name: "–ë–ª–æ–Ω–¥–∏–Ω", color: "#D8A85C" },
            9: { name: "–°–≤–µ—Ç–ª—ã–π –±–ª–æ–Ω–¥–∏–Ω", color: "#F0C67A" },
            10: { name: "–°–≤–µ—Ç–ª–µ–π—à–∏–π –±–ª–æ–Ω–¥–∏–Ω", color: "#FFE1A3" }
        };

    const toneData = {
             0: { name: "–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π", color: "#D1BCA4", range: [1, 10] },
    1: { name: "–ü–µ–ø–µ–ª—å–Ω—ã–π", color: "#B0C0C0", range: [7, 10] },
    2: { name: "–ú–∞—Ç–æ–≤—ã–π", color: "#EEE6D5", range: [8, 10] },
    3: { name: "–ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π", color: "#E5BF65", range: [5, 10] },
    4: { name: "–ú–µ–¥–Ω—ã–π", color: "#C06835", range: [4, 7] },
    5: { name: "–ë–µ–∂–µ–≤—ã–π", color: "#D6B595", range: [6, 9] },
    6: { name: "–ö—Ä–∞—Å–Ω—ã–π", color: "#982845", range: [3, 6] },
    7: { name: "–ú–∞—Ö–∞–≥–æ–Ω", color: "#773F2A", range: [3, 5] },
    8: { name: "–ö–∞—Ä–∞–º–µ–ª—å–Ω—ã–π", color: "#E59035", range: [5, 8] },
    9: { name: "–Ø—Ä–∫–æ-–º–µ–¥–Ω—ã–π", color: "#D55825", range: [4, 6] },
    10: { name: "–§–∏–æ–ª–µ—Ç–æ–≤—ã–π", color: "#885088", range: [7, 9] },
    11: { name: "–ü–µ–ø–µ–ª—å–Ω–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π", color: "#A080A0", range: [7, 10] },
    12: { name: "–°–∏–Ω–∏–π", color: "#385688", range: [7, 9] }
};

        // –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏–∏ (–æ—Å—Ç–∞–≤–ª–µ–Ω–∞, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ UI)
        class ColorProfessional {
            // –ü–æ–ª—É—á–∏—Ç—å —Ñ–æ–Ω –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è –¥–ª—è —É—Ä–æ–≤–Ω—è
            static getLighteningBackground(level) {
                const backgrounds = {
                    1: { 
                        name: "–°–ò–ù–ò–ô", 
                        color: "#1a237e",
                        corrector: "–û—Ä–∞–Ω–∂–µ–≤—ã–π/–ú–µ–¥–Ω—ã–π",
                        dosage: "15-25 –º–ª/100–≥",
                        purpose: "–ù–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏–Ω–µ–≥–æ –¥–ª—è —Ç–µ–º–Ω—ã—Ö —Ç–æ–Ω–æ–≤"
                    },
                    2: { 
                        name: "–§–ò–û–õ–ï–¢–û–í–û-–°–ò–ù–ò–ô", 
                        color: "#311b92",
                        corrector: "–ñ–µ–ª—Ç–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–π",
                        dosage: "12-20 –º–ª/100–≥",
                        purpose: "–ù–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏–Ω–µ-—Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–≥–æ"
                    },
                    3: { 
                        name: "–§–ò–û–õ–ï–¢–û–í–´–ô", 
                        color: "#4a148c",
                        corrector: "–ñ–µ–ª—Ç—ã–π",
                        dosage: "10-18 –º–ª/100–≥",
                        purpose: "–ù–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–≥–æ"
                    },
                    4: { 
                        name: "–ö–†–ê–°–ù–û-–§–ò–û–õ–ï–¢–û–í–´–ô", 
                        color: "#6a1b9a",
                        corrector: "–ñ–µ–ª—Ç–æ-–∑–µ–ª–µ–Ω—ã–π",
                        dosage: "8-15 –º–ª/100–≥",
                        purpose: "–°–ª–æ–∂–Ω–∞—è –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è"
                    },
                    5: { 
                        name: "–ö–†–ê–°–ù–û-–ö–û–†–ò–ß–ù–ï–í–´–ô", 
                        color: "#8b4513",
                        corrector: "–ó–µ–ª–µ–Ω—ã–π",
                        dosage: "7-12 –º–ª/100–≥",
                        purpose: "–ù–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä–∞—Å–Ω–æ–≥–æ"
                    },
                    6: { 
                        name: "–ö–†–ê–°–ù–´–ô", 
                        color: "#c62828",
                        corrector: "–ó–µ–ª–µ–Ω—ã–π",
                        dosage: "5-10 –º–ª/100–≥",
                        purpose: "–ù–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä–∞—Å–Ω–æ–≥–æ —Ñ–æ–Ω–∞"
                    },
                    7: { 
                        name: "–ö–†–ê–°–ù–û-–û–†–ê–ù–ñ–ï–í–´–ô", 
                        color: "#ef6c00",
                        corrector: "–°–∏–Ω–∏–π",
                        dosage: "3-8 –º–ª/100–≥",
                        purpose: "–ù–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ä–∞–Ω–∂–µ–≤–æ–≥–æ"
                    },
                    8: { 
                        name: "–û–†–ê–ù–ñ–ï–í–´–ô", 
                        color: "#ff9800",
                        corrector: "–°–∏–Ω–∏–π",
                        dosage: "2-6 –º–ª/100–≥",
                        purpose: "–ö–æ–Ω—Ç—Ä–æ–ª—å –æ—Ä–∞–Ω–∂–µ–≤–æ–≥–æ"
                    },
                    9: { 
                        name: "–ñ–ï–õ–¢–û-–û–†–ê–ù–ñ–ï–í–´–ô", 
                        color: "#ffb74d",
                        corrector: "–°–∏–Ω–∏–π/–§–∏–æ–ª–µ—Ç–æ–≤—ã–π",
                        dosage: "1-4 –º–ª/100–≥",
                        purpose: "–î–µ–ª–∏–∫–∞—Ç–Ω–∞—è –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è"
                    },
                    10: { 
                        name: "–ñ–ï–õ–¢–´–ô", 
                        color: "#ffeb3b",
                        corrector: "–§–∏–æ–ª–µ—Ç–æ–≤—ã–π/–°–µ—Ä–µ–±—Ä–∏—Å—Ç—ã–π",
                        dosage: "0.5-2 –º–ª/100–≥",
                        purpose: "–¢–æ–Ω–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –±–ª–æ–Ω–¥–∞"
                    }
                };
                return backgrounds[level] || { name: "–ù–ï–¢", color: "#fff", corrector: "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è", dosage: "0 –º–ª/100–≥" };
            }

            // –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏–∏
            static getNeutralizationAdvice(level, tone) {
                const background = this.getLighteningBackground(level);
                const toneInfo = toneData[tone];
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω—É–∂–Ω–∞ –ª–∏ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è
                const warmTones = ["3", "4", "5", "8", "9"];
                const coldTones = ["1", "2", "10", "12", "0"];
                
                let needsNeutralization = false;
                let message = "";
                
                if (level >= 9 && coldTones.includes(tone.toString())) {
                    needsNeutralization = true;
                    message = "–¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–Ω–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –±–ª–æ–Ω–¥–∞";
                } else if (level <= 4 && coldTones.includes(tone.toString())) {
                    needsNeutralization = true;
                    message = "–¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∞—è –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è";
                } else if (level >= 5 && level <= 8) {
                    if (background.name.includes("–ö–†–ê–°–ù") && coldTones.includes(tone.toString())) {
                        needsNeutralization = true;
                        message = "–¢—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–Ω—Ç—Ä–æ–ª—å —Ñ–æ–Ω–∞";
                    }
                }
                
                if (!needsNeutralization) {
                    return {
                        required: false,
                        background: background,
                        message: `‚úÖ –§–æ–Ω –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è (${background.name}) —Å–æ–≤–º–µ—Å—Ç–∏–º —Å —Ç–æ–Ω–æ–º ${toneInfo.name}`
                    };
                }
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä—ã
                let correctors = [];
                const toneStr = tone.toString();
                
                if (toneStr === "1") {
                    correctors = [
                        { name: "–°–ò–ù–ò–ô (.12)", color: "#3C5A8C", dosage: level >= 7 ? "2-5 –º–ª/100–≥" : "5-10 –º–ª/100–≥" },
                        { name: "–§–ò–û–õ–ï–¢–û–í–´–ô (.10)", color: "#8C548C", dosage: level >= 7 ? "1-3 –º–ª/100–≥" : "3-6 –º–ª/100–≥" }
                    ];
                } else if (toneStr === "2") {
                    correctors = [
                        { name: "–°–ï–†–ï–ë–†–ò–°–¢–´–ô –ü–ï–†–õ–ê–ú–£–¢–†", color: "#D8BFD8", dosage: "1-3 –º–ª/100–≥" },
                        { name: "–§–ò–û–õ–ï–¢–û–í–´–ô (.10)", color: "#8C548C", dosage: "1-2 –º–ª/100–≥" }
                    ];
                } else if (["10", "12"].includes(toneStr)) {
                    correctors = [
                        { name: toneStr === "10" ? "–§–ò–û–õ–ï–¢–û–í–´–ô (.10)" : "–°–ò–ù–ò–ô (.12)", color: toneStr === "10" ? "#8C548C" : "#3C5A8C", dosage: level >= 7 ? "2-4 –º–ª/100–≥" : "4-8 –º–ª/100–≥" }
                    ];
                } else {
                    correctors = [
                        { name: "–°–¢–ê–ù–î–ê–†–¢–ù–´–ô –ö–û–†–†–ï–ö–¢–û–†", color: "#888", dosage: "3-6 –º–ª/100–≥" }
                    ];
                }
                
                return {
                    required: true,
                    background: background,
                    correctors: correctors,
                    message: message
                };
            }

            // –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—é
            static getLighteningAdvice(level, tone) {
                let stages, oxidizer, proportions, time;
                
                if (level <= 3) {
                    stages = "3-4 –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 3-4 –Ω–µ–¥–µ–ª–∏";
                    oxidizer = "12% –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —ç—Ç–∞–ø–∞, –∑–∞—Ç–µ–º 9%";
                    proportions = "1:2";
                    time = "50-60 –º–∏–Ω—É—Ç";
                } else if (level <= 6) {
                    stages = "1-2 –ø—Ä–æ—Ü–µ–¥—É—Ä—ã";
                    oxidizer = "9%";
                    proportions = "1:1.5";
                    time = "40-50 –º–∏–Ω—É—Ç";
                } else if (level <= 8) {
                    stages = "1 –ø—Ä–æ—Ü–µ–¥—É—Ä–∞";
                    oxidizer = "6%";
                    proportions = "1:1";
                    time = "35-45 –º–∏–Ω—É—Ç";
                } else {
                    stages = "–¢–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è";
                    oxidizer = "1.5-3%";
                    proportions = "1:2";
                    time = "20-30 –º–∏–Ω—É—Ç";
                }
                
                return { stages, oxidizer, proportions, time };
            }

            // –ü–æ–ª—É—á–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç —Å–º–µ—à–∏–≤–∞–Ω–∏—è
            static getMixingRecipe(level, tone) {
                let baseAmount, mixerAmount, oxidizerAmount, correctorAmount;
                
                if (level >= 9) {
                    baseAmount = 45;
                    mixerAmount = 5;
                    oxidizerAmount = 90;
                    correctorAmount = 0.5;
                } else if (level >= 7) {
                    baseAmount = 40;
                    mixerAmount = 10;
                    oxidizerAmount = 50;
                    correctorAmount = 2;
                } else if (level >= 5) {
                    baseAmount = 35;
                    mixerAmount = 15;
                    oxidizerAmount = 75;
                    correctorAmount = 5;
                } else {
                    baseAmount = 30;
                    mixerAmount = 20;
                    oxidizerAmount = 100;
                    correctorAmount = 10;
                }
                
                let oxidizerPercent;
                if (level >= 9) oxidizerPercent = "1.5-3%";
                else if (level >= 7) oxidizerPercent = "6%";
                else if (level >= 5) oxidizerPercent = "9%";
                else oxidizerPercent = "12%";
                
                return {
                    base: `${baseAmount}–≥ –æ—Å–Ω–æ–≤—ã ${level}.0`,
                    mixer: `${mixerAmount}–≥ –º–∏–∫—Å—Ç–æ–Ω–∞ .${tone}`,
                    oxidizer: `${oxidizerAmount}–≥ –æ–∫–∏—Å–ª–∏—Ç–µ–ª—è ${oxidizerPercent}`,
                    corrector: correctorAmount > 0 ? `${correctorAmount}–≥ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞` : "–ë–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞",
                    total: `100–≥ –≥–æ—Ç–æ–≤–æ–π —Å–º–µ—Å–∏`
                };
            }
        }

        // ============================================
        // –ò–ù–¢–ï–†–§–ï–ô–°
        // ============================================

        let currentDepth = null;
        let currentTone = null;

        function isValidCombination(depth, tone) {
            if (!toneData[tone]) return false;
            const range = toneData[tone].range;
            return depth >= range[0] && depth <= range[1];
        }

        function createDepthSegments() {
            const depthCircle = document.getElementById('depthCircle');
            const depthCount = 10;
            const angleStep = 360 / depthCount;
            
            for (let i = 0; i < depthCount; i++) {
                const depthNum = i + 1;
                const segment = document.createElement('div');
                segment.className = `segment depth-${depthNum}`;
                segment.dataset.depth = depthNum;
                
                const rotation = angleStep * i;
                segment.style.transform = `rotate(${rotation}deg)`;
                
                const number = document.createElement('div');
                number.className = 'segment-number';
                number.textContent = depthNum;
                segment.appendChild(number);
                
                segment.addEventListener('click', () => selectDepth(depthNum));
                depthCircle.appendChild(segment);
            }
        }

        function createToneSegments() {
    const toneCircle = document.getElementById('toneCircle');
    const tones = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]; // 13 —Ç–æ–Ω–æ–≤
            const toneCount = tones.length;
            const angleStep = 360 / toneCount;
            
            for (let i = 0; i < toneCount; i++) {
                const toneNum = tones[i];
                const segment = document.createElement('div');
                segment.className = `segment tone-${toneNum}`;
                segment.dataset.tone = toneNum;
                
                const rotation = angleStep * i;
                segment.style.transform = `rotate(${rotation}deg)`;
                
                const number = document.createElement('div');
                number.className = 'segment-number';
                number.textContent = toneNum;
                segment.appendChild(number);
                
                segment.addEventListener('click', () => selectTone(toneNum));
                toneCircle.appendChild(segment);
            }
        }

        function selectDepth(depth) {
            document.querySelectorAll('.depth-circle .segment').forEach(seg => {
                seg.classList.remove('selected');
            });
            
            const segment = document.querySelector(`.depth-circle .segment[data-depth="${depth}"]`);
            if (segment) {
                segment.classList.add('selected');
                currentDepth = depth;
                updateToneAvailability();
                updateDisplay();
            }
        }

        function selectTone(tone) {
            document.querySelectorAll('.tone-circle .segment').forEach(seg => {
                seg.classList.remove('selected');
            });
            
            const segment = document.querySelector(`.tone-circle .segment[data-tone="${tone}"]`);
            if (segment && !segment.classList.contains('disabled')) {
                segment.classList.add('selected');
                currentTone = tone;
                updateDisplay();
            }
        }

        function updateToneAvailability() {
            document.querySelectorAll('.tone-circle .segment').forEach(segment => {
                const tone = parseInt(segment.dataset.tone);
                segment.classList.remove('disabled');
                
                if (currentDepth && !isValidCombination(currentDepth, tone)) {
                    segment.classList.add('disabled');
                    segment.classList.remove('selected');
                    if (currentTone === tone) currentTone = null;
                }
            });
        }

        function selectExample(depth, tone) {
            selectDepth(depth);
            selectTone(tone);
        }

        function updateDisplay() {
            const errorContainer = document.getElementById('errorContainer');
            const errorMessage = document.getElementById('errorMessage');
            
            if (currentDepth !== null && currentTone !== null) {
                const colorCode = `${currentDepth}.${currentTone}`;
                document.getElementById('selectedColorCode').textContent = colorCode;
                
                if (!isValidCombination(currentDepth, currentTone)) {
                    errorContainer.classList.add('show');
                    errorMessage.innerHTML = `
                        –ù–µ–≤–æ–∑–º–æ–∂–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è
                    `;
                    document.getElementById('selectedColorName').textContent = "–û—à–∏–±–∫–∞";
                    return;
                }
                
                errorContainer.classList.remove('show');
                updateColorInfo();
            }
        }

        function generatePreviewColor(depth, tone) {
    const depthColor = depthData[depth].color;
    const toneColor = toneData[tone].color;
    
    const hexToRgb = hex => {
        const r = parseInt(hex.slice(1, 3), 16);
        const g = parseInt(hex.slice(3, 5), 16);
        const b = parseInt(hex.slice(5, 7), 16);
        return { r, g, b };
    };
    
    const rgb1 = hexToRgb(depthColor);
    const rgb2 = hexToRgb(toneColor);
    
    // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è –≥–ª—É–±–∏–Ω—ã
    let depthWeight = 0.7; // –í–µ—Å –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
    let toneWeight = 0.3;  // –í–µ—Å —Ç–æ–Ω–∞
    
    if (depth >= 8) {
        // –ù–∞ —Å–≤–µ—Ç–ª—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –±–æ–ª—å—à–µ –≤–ª–∏—è–Ω–∏–µ —Ç–æ–Ω–∞
        depthWeight = 0.5;
        toneWeight = 0.5;
    } else if (depth <= 4) {
        // –ù–∞ —Ç–µ–º–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –º–µ–Ω—å—à–µ –≤–ª–∏—è–Ω–∏–µ —Ç–æ–Ω–∞
        depthWeight = 0.8;
        toneWeight = 0.2;
    }
    
    const r = Math.round(rgb1.r * depthWeight + rgb2.r * toneWeight);
    const g = Math.round(rgb1.g * depthWeight + rgb2.g * toneWeight);
    const b = Math.round(rgb1.b * depthWeight + rgb2.b * toneWeight);
    
    const rgbToHex = (r, g, b) => {
        return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
    };
    
    return rgbToHex(r, g, b);
}

        function updateColorInfo() {
            const container = document.getElementById('colorInfoContainer');
            const colorCode = `${currentDepth}.${currentTone}`;
            const toneName = toneData[currentTone].name;
            const depthName = depthData[currentDepth].name;
            const previewColor = generatePreviewColor(currentDepth, currentTone);
            
            const background = ColorProfessional.getLighteningBackground(currentDepth);
            const lightening = ColorProfessional.getLighteningAdvice(currentDepth, currentTone);
            const recipe = ColorProfessional.getMixingRecipe(currentDepth, currentTone);
             // =========== –î–û–ë–ê–í–õ–Ø–ï–ú –≠–¢–£ –ü–ï–†–ï–ú–ï–ù–ù–£–Æ ===========
    let tone11SpecialNote = "";
    
    if (currentTone === 11) {
        tone11SpecialNote = `
            <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); border-radius: 10px; border-left: 4px solid #A080A0; border-right: 4px solid #A080A0;">
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                    <div style="width: 30px; height: 30px; background: #A080A0; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.1);"></div>
                    <div style="font-weight: 700; color: #4a148c; font-size: 1.1rem;">üíé –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å —Ç–æ–Ω–∞ .11</div>
                </div>
                <div style="color: #555; font-size: 0.95rem; line-height: 1.4;">
                    <strong>–ü–µ–ø–µ–ª—å–Ω–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π (.11)</strong> ‚Äî –º—è–≥–∫–∏–π —Å–µ—Ä–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π –æ—Ç—Ç–µ–Ω–æ–∫, –∞–Ω–∞–ª–æ–≥ .21 –∏–ª–∏ .12 –≤ Kapous.<br>
                    <strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:</strong> –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è —Ö–æ–ª–æ–¥–Ω—ã—Ö –±–ª–æ–Ω–¥–æ–≤ (8-10 —É—Ä–æ–≤–µ–Ω—å), –Ω–µ–π—Ç—Ä–∞–ª–∏–∑—É–µ—Ç –∂–µ–ª—Ç–∏–∑–Ω—É, —Å–æ–∑–¥–∞–µ—Ç –ø–ª–∞—Ç–∏–Ω–æ–≤—ã–π/—Å–µ—Ä–µ–±—Ä–∏—Å—Ç—ã–π —ç—Ñ—Ñ–µ–∫—Ç.<br>
                    <strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</strong> –î–∞–µ—Ç –º–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ö–æ–ª–æ–¥–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç —á–µ–º tone-1, –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–µ–ª–∏–∫–∞—Ç–Ω–æ–≥–æ —Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.
                </div>
            </div>
        `;
    }
    // =========== –ö–û–ù–ï–¶ –î–û–ë–ê–í–õ–ï–ù–ò–Ø ===========
            container.innerHTML = `
                <div class="color-recipe" style="border-left-color: ${previewColor}">
                    <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #f0f0f0;">
                        <div style="width: 80px; height: 80px; background: ${previewColor}; border-radius: 12px; border: 3px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.1); flex-shrink: 0;"></div>
                        <div style="flex: 1;">
                            <h4 style="color: #4a148c; margin-bottom: 5px; font-size: 1.3rem;">${depthName} ${toneName.toLowerCase()}</h4>
                            <p style="color: #ff5722; font-weight: 600; font-size: 1.1rem;">–ö–æ–¥: ${colorCode}</p>
                        </div>
                    </div>
                    
                    <div class="info-section">
                        <div class="section-title">üìä –û–°–ù–û–í–ù–´–ï –ü–ê–†–ê–ú–ï–¢–†–´</div>
                        <div class="info-row">
                            <span class="info-label">–£—Ä–æ–≤–µ–Ω—å –≥–ª—É–±–∏–Ω—ã:</span>
                            <span class="info-value">${currentDepth} (${depthName})</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</span>
                            <span class="info-value">${currentTone} (${toneName})</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–§–æ–Ω –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è:</span>
                            <span class="info-value" style="color: ${background.color};">${background.name}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä:</span>
                            <span class="info-value">${background.corrector}</span>
                        </div>
                    </div>
                    
                    <div class="info-section highlight">
                        <div class="section-title">‚ö° –ü–†–û–¶–ï–°–° –û–°–í–ï–¢–õ–ï–ù–ò–Ø</div>
                        <div class="info-row">
                            <span class="info-label">–≠—Ç–∞–ø—ã:</span>
                            <span class="info-value">${lightening.stages}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</span>
                            <span class="info-value">${lightening.oxidizer}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–ü—Ä–æ–ø–æ—Ä—Ü–∏–∏:</span>
                            <span class="info-value">${lightening.proportions}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–í—Ä–µ–º—è –≤—ã–¥–µ—Ä–∂–∫–∏:</span>
                            <span class="info-value">${lightening.time}</span>
                        </div>
                    </div>
                    
                    <div class="info-section">
                        <div class="section-title">üß™ –†–ï–¶–ï–ü–¢ –°–ú–ï–®–ò–í–ê–ù–ò–Ø (–Ω–∞ 100–≥)</div>
                        <div class="recipe-grid">
                            <div class="recipe-item">
                                <div class="recipe-amount">${recipe.base.split(' ')[0]}</div>
                                <div class="recipe-name">–û—Å–Ω–æ–≤–∞ ${currentDepth}.0</div>
                            </div>
                            <div class="recipe-item">
                                <div class="recipe-amount">${recipe.mixer.split(' ')[0]}</div>
                                <div class="recipe-name">–ú–∏–∫—Å—Ç–æ–Ω .${currentTone}</div>
                            </div>
                            <div class="recipe-item">
                                <div class="recipe-amount">${recipe.oxidizer.split(' ')[0]}</div>
                                <div class="recipe-name">–û–∫–∏—Å–ª–∏—Ç–µ–ª—å ${recipe.oxidizer.split(' ')[2]}</div>
                            </div>
                            <div class="recipe-item">
                                <div class="recipe-amount">${recipe.corrector !== "–ë–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞" ? recipe.corrector.split(' ')[0] : "-"}</div>
                                <div class="recipe-name">${recipe.corrector !== "–ë–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞" ? "–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä" : "–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä"}</div>
                            </div>
                        </div>
                        <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #4a148c 0%, #6a1b9a 100%); color: white; border-radius: 12px; text-align: center;">
                            <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 5px;">üé® –ò–¢–û–ì–û –ì–û–¢–û–í–û–ô –°–ú–ï–°–ò</div>
                            <div style="font-size: 1.8rem; font-weight: 800;">${recipe.total}</div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('selectedColorName').textContent = `${depthName} ${toneName.toLowerCase()}`;
        }

        // –ò–ù–°–¢–†–£–ú–ï–ù–¢–´
        // ============================================

function showMixingCalculator() {
    showModal("üßÆ –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –°–ú–ï–®–ò–í–ê–ù–ò–Ø",
        `<div class="modal-section">
            <h3>üìä –†–ê–°–ß–ï–¢ –ü–†–û–ü–û–†–¶–ò–ô:</h3>
            <div style="padding: 20px;">
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #4a148c;">–û–±—ä–µ–º —Å–º–µ—Å–∏ (–≥):</label>
                        <input type="number" id="totalVolume" value="100" min="50" max="500" step="10"
                               style="width: 100%; padding: 12px; border: 2px solid #4a148c; border-radius: 8px; font-size: 1.1em;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #ff5722;">–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ:</label>
                        <select id="mixRatio" style="width: 100%; padding: 12px; border: 2px solid #ff5722; border-radius: 8px; font-size: 1.1em;">
                            <option value="70-30">–û—Å–Ω–æ–≤–∞ 70% : –ú–∏–∫—Å—Ç–æ–Ω 30%</option>
                            <option value="60-40" selected>–û—Å–Ω–æ–≤–∞ 60% : –ú–∏–∫—Å—Ç–æ–Ω 40%</option>
                            <option value="50-50">–û—Å–Ω–æ–≤–∞ 50% : –ú–∏–∫—Å—Ç–æ–Ω 50%</option>
                            <option value="40-60">–û—Å–Ω–æ–≤–∞ 40% : –ú–∏–∫—Å—Ç–æ–Ω 60%</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #4a148c;">–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</label>
                        <select id="oxidizerPercent" style="width: 100%; padding: 12px; border: 2px solid #4a148c; border-radius: 8px; font-size: 1.1em;">
                            <option value="1.5">1.5% (5 vol)</option>
                            <option value="3">3% (10 vol)</option>
                            <option value="6" selected>6% (20 vol)</option>
                            <option value="9">9% (30 vol)</option>
                            <option value="12">12% (40 vol)</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #ff5722;">–ü—Ä–æ–ø–æ—Ä—Ü–∏–∏ —Å –æ–∫–∏—Å–ª–∏—Ç–µ–ª–µ–º:</label>
                        <select id="oxRatio" style="width: 100%; padding: 12px; border: 2px solid #ff5722; border-radius: 8px; font-size: 1.1em;">
                            <option value="1-1.5">1 : 1.5 (–¥–ª—è —Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)</option>
                            <option value="1-1" selected>1 : 1 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç)</option>
                            <option value="1.5-1">1.5 : 1 (–¥–ª—è —Ç–µ–º–Ω—ã—Ö)</option>
                        </select>
                    </div>
                </div>
                
                <button onclick="calculateMixing()" 
                        style="width: 100%; padding: 15px; background: linear-gradient(135deg, #4a148c 0%, #6a1b9a 100%); 
                               color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; 
                               font-size: 1.1em; margin-bottom: 20px; transition: transform 0.2s;" 
                        onmouseover="this.style.transform='scale(1.02)'" 
                        onmouseout="this.style.transform='scale(1)'">
                    üßÆ –†–ê–°–°–ß–ò–¢–ê–¢–¨ –°–ú–ï–°–¨
                </button>
                
                <div id="mixingResult" style="background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); 
                    padding: 20px; border-radius: 10px; border-left: 6px solid #9c27b0; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    <strong style="color: #4a148c; font-size: 1.2em;">üìã –†–ï–ó–£–õ–¨–¢–ê–¢:</strong>
                    <div style="margin-top: 15px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="color: #666; font-size: 0.9em;">–û—Å–Ω–æ–≤–∞</div>
                            <div style="font-size: 1.8em; font-weight: 800; color: #4a148c;" id="resultBase">60 –≥</div>
                            <div style="color: #666; font-size: 0.9em;">60%</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="color: #666; font-size: 0.9em;">–ú–∏–∫—Å—Ç–æ–Ω</div>
                            <div style="font-size: 1.8em; font-weight: 800; color: #ff5722;" id="resultMix">40 –≥</div>
                            <div style="color: #666; font-size: 0.9em;">40%</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="color: #666; font-size: 0.9em;">–û–∫–∏—Å–ª–∏—Ç–µ–ª—å</div>
                            <div style="font-size: 1.8em; font-weight: 800; color: #009688;" id="resultOx">100 –≥</div>
                            <div style="color: #666; font-size: 0.9em;" id="resultOxPercent">6%</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="color: #666; font-size: 0.9em;">–ò—Ç–æ–≥–æ</div>
                            <div style="font-size: 1.8em; font-weight: 800; color: #9c27b0;" id="resultTotal">200 –≥</div>
                            <div style="color: #666; font-size: 0.9em;">–ì–æ—Ç–æ–≤–∞—è —Å–º–µ—Å—å</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="modal-section">
            <h3>üìè –°–¢–ê–ù–î–ê–†–¢–ù–´–ï –ü–†–û–ü–û–†–¶–ò–ò:</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 15px;">
                <div style="padding: 15px; background: #e8f5e9; border-radius: 10px; border-left: 4px solid #4caf50;">
                    <strong style="color: #2e7d32;">üé® –¢–û–ù–ò–†–û–í–ê–ù–ò–ï</strong>
                    <div style="margin-top: 8px; font-size: 0.95em;">
                        <div>‚Ä¢ –û—Å–Ω–æ–≤–∞: 70%</div>
                        <div>‚Ä¢ –ú–∏–∫—Å—Ç–æ–Ω: 30%</div>
                        <div>‚Ä¢ –û–∫–∏—Å–ª–∏—Ç–µ–ª—å: 1.5-3%</div>
                        <div>‚Ä¢ –í—Ä–µ–º—è: 15-25 –º–∏–Ω</div>
                    </div>
                </div>
                <div style="padding: 15px; background: #e3f2fd; border-radius: 10px; border-left: 4px solid #2196f3;">
                    <strong style="color: #1565c0;">‚ö° –û–ö–†–ê–®–ò–í–ê–ù–ò–ï</strong>
                    <div style="margin-top: 8px; font-size: 0.95em;">
                        <div>‚Ä¢ –û—Å–Ω–æ–≤–∞: 60%</div>
                        <div>‚Ä¢ –ú–∏–∫—Å—Ç–æ–Ω: 40%</div>
                        <div>‚Ä¢ –û–∫–∏—Å–ª–∏—Ç–µ–ª—å: 6-9%</div>
                        <div>‚Ä¢ –í—Ä–µ–º—è: 30-45 –º–∏–Ω</div>
                    </div>
                </div>
                <div style="padding: 15px; background: #fff3e0; border-radius: 10px; border-left: 4px solid #ff9800;">
                    <strong style="color: #ef6c00;">üéØ –ö–û–†–†–ï–ö–¶–ò–Ø</strong>
                    <div style="margin-top: 8px; font-size: 0.95em;">
                        <div>‚Ä¢ –û—Å–Ω–æ–≤–∞: 50%</div>
                        <div>‚Ä¢ –ú–∏–∫—Å—Ç–æ–Ω: 50%</div>
                        <div>‚Ä¢ –û–∫–∏—Å–ª–∏—Ç–µ–ª—å: 3-6%</div>
                        <div>‚Ä¢ –í—Ä–µ–º—è: 25-35 –º–∏–Ω</div>
                    </div>
                </div>
                <div style="padding: 15px; background: #f3e5f5; border-radius: 10px; border-left: 4px solid #9c27b0;">
                    <strong style="color: #7b1fa2;">üíé –ò–ù–¢–ï–ù–°–ò–í–ù–´–ô –¶–í–ï–¢</strong>
                    <div style="margin-top: 8px; font-size: 0.95em;">
                        <div>‚Ä¢ –û—Å–Ω–æ–≤–∞: 40%</div>
                        <div>‚Ä¢ –ú–∏–∫—Å—Ç–æ–Ω: 60%</div>
                        <div>‚Ä¢ –û–∫–∏—Å–ª–∏—Ç–µ–ª—å: 1.5-3%</div>
                        <div>‚Ä¢ –í—Ä–µ–º—è: 20-30 –º–∏–Ω</div>
                    </div>
                </div>
            </div>
        </div>`
    );
}

function calculateMixing() {
    // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
    const totalVolume = parseInt(document.getElementById('totalVolume').value) || 100;
    const mixRatio = document.getElementById('mixRatio').value;
    const oxidizerPercent = document.getElementById('oxidizerPercent').value;
    const oxRatio = document.getElementById('oxRatio').value;
    
    // –ü–∞—Ä—Å–∏–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ
    const [basePercent, mixPercent] = mixRatio.split('-').map(Number);
    
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    const baseAmount = Math.round(totalVolume * basePercent / 100);
    const mixAmount = Math.round(totalVolume * mixPercent / 100);
    
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–∫–∏—Å–ª–∏—Ç–µ–ª—å
    let oxAmount;
    switch(oxRatio) {
        case '1-1.5':
            oxAmount = Math.round((baseAmount + mixAmount) * 1.5);
            break;
        case '1.5-1':
            oxAmount = Math.round((baseAmount + mixAmount) * 0.67);
            break;
        default: // 1:1
            oxAmount = baseAmount + mixAmount;
    }
    
    // –ò—Ç–æ–≥–æ–≤—ã–π –æ–±—ä–µ–º
    const totalAmount = baseAmount + mixAmount + oxAmount;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    document.getElementById('resultBase').textContent = `${baseAmount} –≥`;
    document.getElementById('resultMix').textContent = `${mixAmount} –≥`;
    document.getElementById('resultOx').textContent = `${oxAmount} –≥`;
    document.getElementById('resultOxPercent').textContent = `${oxidizerPercent}%`;
    document.getElementById('resultTotal').textContent = `${totalAmount} –≥`;
    
    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    const resultDiv = document.getElementById('mixingResult');
    resultDiv.style.animation = 'none';
    setTimeout(() => {
        resultDiv.style.animation = 'highlight 0.5s ease';
    }, 10);
}
    function showCorrectorTable() {
    showModal("üé® –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ö–û–†–†–ï–ö–¢–û–†–û–í",
        `<div class="modal-section">
            <h3>üåà –û–°–ù–û–í–ù–´–ï –ö–û–†–†–ï–ö–¢–û–†–´ –î–õ–Ø –ü–ê–†–ò–ö–ú–ê–•–ï–†–û–í:</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin: 15px 0;">
                
                <!-- –°–ò–ù–ò–ô (.12) - –°–∞–º—ã–π –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã–π -->
                <div style="padding: 15px; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border-radius: 10px; border-left: 6px solid #2196f3; border-bottom: 3px solid #1976d2;">
                    <strong style="color: #0d47a1; font-size: 1.1em;">üîµ –°–ò–ù–ò–ô (.12)</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üéØ <strong>–ù–µ–π—Ç—Ä–∞–ª–∏–∑—É–µ—Ç:</strong> –û—Ä–∞–Ω–∂–µ–≤—ã–π –∏ –∂–µ–ª—Ç—ã–π —Ñ–æ–Ω</div>
                        <div>üìè <strong>–î–æ–∑–∏—Ä–æ–≤–∫–∞:</strong> 2-8 –º–ª/100–≥</div>
                        <div>üé® <strong>–î–ª—è —Ç–æ–Ω–æ–≤:</strong> 1, 2, 10</div>
                        <div>üí° <strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ù–∞ 7-10 —É—Ä–æ–≤–Ω—è—Ö, –¥–ª—è –ø–µ–ø–ª–∞</div>
                    </div>
                </div>
                
                <!-- –§–ò–û–õ–ï–¢–û–í–´–ô (.10) - –î–ª—è –ø–ª–∞—Ç–∏–Ω—ã -->
                <div style="padding: 15px; background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); border-radius: 10px; border-left: 6px solid #9c27b0; border-bottom: 3px solid #7b1fa2;">
                    <strong style="color: #4a148c; font-size: 1.1em;">üü£ –§–ò–û–õ–ï–¢–û–í–´–ô (.10)</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üéØ <strong>–ù–µ–π—Ç—Ä–∞–ª–∏–∑—É–µ—Ç:</strong> –ñ–µ–ª—Ç—ã–π —Ñ–æ–Ω</div>
                        <div>üìè <strong>–î–æ–∑–∏—Ä–æ–≤–∫–∞:</strong> 1-5 –º–ª/100–≥</div>
                        <div>üé® <strong>–î–ª—è —Ç–æ–Ω–æ–≤:</strong> 1, 2, 10</div>
                        <div>üí° <strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –î–ª—è –ø–ª–∞—Ç–∏–Ω–æ–≤—ã—Ö –±–ª–æ–Ω–¥–æ–≤</div>
                    </div>
                </div>
                
                <!-- –ó–ï–õ–ï–ù–´–ô - –ü—Ä–æ—Ç–∏–≤ –∫—Ä–∞—Å–Ω–æ—Ç—ã -->
                <div style="padding: 15px; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-radius: 10px; border-left: 6px solid #4caf50; border-bottom: 3px solid #388e3c;">
                    <strong style="color: #1b5e20; font-size: 1.1em;">üü¢ –ó–ï–õ–ï–ù–´–ô</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üéØ <strong>–ù–µ–π—Ç—Ä–∞–ª–∏–∑—É–µ—Ç:</strong> –ö—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω</div>
                        <div>üìè <strong>–î–æ–∑–∏—Ä–æ–≤–∫–∞:</strong> 3-10 –º–ª/100–≥</div>
                        <div>üé® <strong>–î–ª—è —Ç–æ–Ω–æ–≤:</strong> 6, 7</div>
                        <div>üí° <strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ü–æ—Å–ª–µ —Å–º—ã–≤–∫–∏ –∫—Ä–∞—Å–Ω–æ–≥–æ</div>
                    </div>
                </div>
                
                <!-- –ó–û–õ–û–¢–ò–°–¢–´–ô (.3) - –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–ø–ª–æ—Ç—ã -->
                <div style="padding: 15px; background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); border-radius: 10px; border-left: 6px solid #ff9800; border-bottom: 3px solid #f57c00;">
                    <strong style="color: #e65100; font-size: 1.1em;">üü° –ó–û–õ–û–¢–ò–°–¢–´–ô (.3)</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üéØ <strong>–î–æ–±–∞–≤–ª—è–µ—Ç:</strong> –¢–µ–ø–ª–æ—Ç—É, –Ω–µ–π—Ç—Ä–∞–ª–∏–∑—É–µ—Ç —Å–∏–Ω–∏–π</div>
                        <div>üìè <strong>–î–æ–∑–∏—Ä–æ–≤–∫–∞:</strong> 2-6 –º–ª/100–≥</div>
                        <div>üé® <strong>–î–ª—è —Ç–æ–Ω–æ–≤:</strong> 4, 5, 8, 9</div>
                        <div>üí° <strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –£–±–∏—Ä–∞–µ—Ç —Å–∏–Ω–µ–≤—É –ø–µ–ø–ª–∞</div>
                    </div>
                </div>
                
                <!-- –ö–†–ê–°–ù–´–ô (.6) - –î–ª—è –º–µ–¥–∏ -->
                <div style="padding: 15px; background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%); border-radius: 10px; border-left: 6px solid #f44336; border-bottom: 3px solid #d32f2f;">
                    <strong style="color: #b71c1c; font-size: 1.1em;">üî¥ –ö–†–ê–°–ù–´–ô (.6)</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üéØ <strong>–î–æ–±–∞–≤–ª—è–µ—Ç:</strong> –ú–µ–¥–Ω—ã–µ, –∫—Ä–∞—Å–Ω—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏</div>
                        <div>üìè <strong>–î–æ–∑–∏—Ä–æ–≤–∫–∞:</strong> 3-8 –º–ª/100–≥</div>
                        <div>üé® <strong>–î–ª—è —Ç–æ–Ω–æ–≤:</strong> 6, 7, 9</div>
                        <div>üí° <strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ù–µ –¥–ª—è –±–ª–æ–Ω–¥–∞, —Ç–æ–ª—å–∫–æ —Ç–µ–º–Ω—ã–µ</div>
                    </div>
                </div>
                
                <!-- –ú–ê–•–ê–ì–û–ù (.7) - –ì–ª—É–±–æ–∫–∏–π –∫—Ä–∞—Å–Ω—ã–π -->
                <div style="padding: 15px; background: linear-gradient(135deg, #ede7f6 0%, #d1c4e9 100%); border-radius: 10px; border-left: 6px solid #673ab7; border-bottom: 3px solid #512da8;">
                    <strong style="color: #311b92; font-size: 1.1em;">üç∑ –ú–ê–•–ê–ì–û–ù (.7)</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üéØ <strong>–î–æ–±–∞–≤–ª—è–µ—Ç:</strong> –ö—Ä–∞—Å–Ω–æ-–∫–æ—Ä–∏—á–Ω–µ–≤—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏</div>
                        <div>üìè <strong>–î–æ–∑–∏—Ä–æ–≤–∫–∞:</strong> 5-12 –º–ª/100–≥</div>
                        <div>üé® <strong>–î–ª—è —Ç–æ–Ω–æ–≤:</strong> 7, 8</div>
                        <div>üí° <strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –¢–æ–ª—å–∫–æ –Ω–∞ —É—Ä–æ–≤–Ω—è—Ö 3-5</div>
                    </div>
                </div>
                
                <!-- –ú–ï–î–ù–´–ô (.4) - –†—ã–∂–∏–µ —Ç–æ–Ω–∞ -->
                <div style="padding: 15px; background: linear-gradient(135deg, #e0f2f1 0%, #b2dfdb 100%); border-radius: 10px; border-left: 6px solid #009688; border-bottom: 3px solid #00796b;">
                    <strong style="color: #004d40; font-size: 1.1em;">üü† –ú–ï–î–ù–´–ô (.4)</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üéØ <strong>–î–æ–±–∞–≤–ª—è–µ—Ç:</strong> –†—ã–∂–∏–µ, –º–µ–¥–Ω—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏</div>
                        <div>üìè <strong>–î–æ–∑–∏—Ä–æ–≤–∫–∞:</strong> 4-10 –º–ª/100–≥</div>
                        <div>üé® <strong>–î–ª—è —Ç–æ–Ω–æ–≤:</strong> 4, 9</div>
                        <div>üí° <strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –¢—Ä–µ–±—É–µ—Ç —Ö–æ—Ä–æ—à–µ–≥–æ —Ñ–æ–Ω–∞</div>
                    </div>
                </div>
                
                <!-- –ñ–ï–õ–¢–´–ô - –Ø—Ä–∫–æ—Å—Ç—å -->
                <div style="padding: 15px; background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%); border-radius: 10px; border-left: 6px solid #ffc107; border-bottom: 3px solid #ffa000;">
                    <strong style="color: #ff6f00; font-size: 1.1em;">‚≠ê –ñ–ï–õ–¢–´–ô</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üéØ <strong>–î–æ–±–∞–≤–ª—è–µ—Ç:</strong> –Ø—Ä–∫–æ—Å—Ç—å, —Ç–µ–ø–ª–æ—Ç—É</div>
                        <div>üìè <strong>–î–æ–∑–∏—Ä–æ–≤–∫–∞:</strong> 1-4 –º–ª/100–≥</div>
                        <div>üé® <strong>–î–ª—è —Ç–æ–Ω–æ–≤:</strong> 3, 4</div>
                        <div>üí° <strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –û—Å–≤–µ—Ç–ª—è–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–∏—è–Ω–∏–µ</div>
                    </div>
                </div>
                
            </div>
        </div>

        <div class="modal-section">
            <h3>üéØ –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ò–ù–¶–ò–ü–´ –†–ê–ë–û–¢–´:</h3>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin: 15px 0;">
                <div style="padding: 15px; background: #fff3e0; border-radius: 10px; border-left: 5px solid #ff9800;">
                    <strong>üìä –¶–í–ï–¢–û–í–û–ô –ö–†–£–ì:</strong>
                    <p>üîµ <strong>–°–∏–Ω–∏–π</strong> ‚Üí üü† –û—Ä–∞–Ω–∂–µ–≤—ã–π</p>
                    <p>üü£ <strong>–§–∏–æ–ª–µ—Ç–æ–≤—ã–π</strong> ‚Üí üü° –ñ–µ–ª—Ç—ã–π</p>
                    <p>üü¢ <strong>–ó–µ–ª–µ–Ω—ã–π</strong> ‚Üí üî¥ –ö—Ä–∞—Å–Ω—ã–π</p>
                </div>
                
                <div style="padding: 15px; background: #f3e5f5; border-radius: 10px; border-left: 5px solid #9c27b0;">
                    <strong>‚ö° –ë–´–°–¢–†–´–ï –†–ï–®–ï–ù–ò–Ø:</strong>
                    <p>‚Ä¢ –ü–µ–ø–µ–ª –¥–∞–ª —Å–∏–Ω–µ–≤—É ‚Üí +2–º–ª –∑–æ–ª–æ—Ç–æ–≥–æ</p>
                    <p>‚Ä¢ –ú–µ–¥—å —Å–ª–∏—à–∫–æ–º —è—Ä–∫–∞—è ‚Üí +1–º–ª –∑–µ–ª–µ–Ω–æ–≥–æ</p>
                    <p>‚Ä¢ –¶–≤–µ—Ç —Ç—É—Å–∫–ª—ã–π ‚Üí –ø—Ä–æ–≤–µ—Ä—å —Ñ–æ–Ω –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è</p>
                </div>
            </div>
            
            <div style="background: #e8f5e9; padding: 15px; border-radius: 10px; margin: 15px 0; border-left: 5px solid #4caf50;">
                <strong>üí° –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–´–ï –°–û–í–ï–¢–´:</strong>
                <ul style="margin: 10px 0 0 20px;">
                    <li>–í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ —Ç–µ—Å—Ç-–ø—Ä—è–¥—å –ø–µ—Ä–µ–¥ —Ä–∞–±–æ—Ç–æ–π</li>
                    <li>–£—á–∏—Ç—ã–≤–∞–π—Ç–µ –ø–æ—Ä–∏—Å—Ç–æ—Å—Ç—å –≤–æ–ª–æ—Å: –ø–æ—Ä–∏—Å—Ç—ã–µ = –±–æ–ª—å—à–µ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞</li>
                    <li>–•–æ–ª–æ–¥–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±—ã—Å—Ç—Ä–µ–µ —Ç–µ–ø–ª—ã—Ö</li>
                    <li>–°–º–µ—à–∏–≤–∞–π—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä—ã –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á</li>
                    <li>–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –∫—Ä–∞—Å–∏—Ç–µ–ª–µ–º</li>
                </ul>
            </div>
            
            <div style="background: #ffebee; padding: 15px; border-radius: 10px; border-left: 5px solid #f44336;">
                <strong>‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò:</strong>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px;">
                    <div>
                        <p>‚Ä¢ –ú–∞–∫—Å–∏–º—É–º 15% –æ—Ç —Å–º–µ—Å–∏</p>
                        <p>‚Ä¢ –ù–µ –±–æ–ª–µ–µ 2 –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–æ–≤</p>
                    </div>
                    <div>
                        <p>‚Ä¢ –¢–µ—Å—Ç –Ω–∞ –∞–ª–ª–µ—Ä–≥–∏—é</p>
                        <p>‚Ä¢ –£—á–∏—Ç—ã–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è</p>
                    </div>
        </div>`
    );
}

function showColorTables() {
    showModal("üåà –ü–û–õ–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –¶–í–ï–¢–û–í",
        `<div class="modal-section">
            <h3>üìä –£–†–û–í–ù–ò –ì–õ–£–ë–ò–ù–´ –¢–û–ù–ê (1-10):</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 15px 0;">
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #000000;"></div>
                    <div><strong>1</strong> - –ß–µ—Ä–Ω—ã–π</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #2C1810;"></div>
                    <div><strong>2</strong> - –¢–µ–º–Ω–æ-–∫–æ—Ä–∏—á–Ω–µ–≤—ã–π</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #422A1A;"></div>
                    <div><strong>3</strong> - –ö–æ—Ä–∏—á–Ω–µ–≤—ã–π</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #5C3A22;"></div>
                    <div><strong>4</strong> - –¢–µ–º–Ω—ã–π —à–∞—Ç–µ–Ω</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #7A4F2E;"></div>
                    <div><strong>5</strong> - –®–∞—Ç–µ–Ω</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #9C6D3C;"></div>
                    <div><strong>6</strong> - –†—É—Å—ã–π</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #BD8B4A;"></div>
                    <div><strong>7</strong> - –°–≤–µ—Ç–ª—ã–π —Ä—É—Å—ã–π</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #D8A85C;"></div>
                    <div><strong>8</strong> - –ë–ª–æ–Ω–¥–∏–Ω</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #F0C67A;"></div>
                    <div><strong>9</strong> - –°–≤–µ—Ç–ª—ã–π –±–ª–æ–Ω–¥–∏–Ω</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #FFE1A3;"></div>
                    <div><strong>10</strong> - –°–≤–µ—Ç–ª–µ–π—à–∏–π –±–ª–æ–Ω–¥–∏–Ω</div>
                </div>
            </div>
        </div>

        <div class="modal-section">
            <h3>üé® –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø –¶–í–ï–¢–ê (–ú–ò–ö–°–¢–û–ù–´):</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 15px 0;">
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #D4BFA6;"></div>
                    <div><strong>0</strong> - –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π (1-10)</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #A8B8B8;"></div>
                    <div><strong>1</strong> - –ü–µ–ø–µ–ª—å–Ω—ã–π (7-10)</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #F0E9D8;"></div>
                    <div><strong>2</strong> - –ú–∞—Ç–æ–≤—ã–π (8-10)</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #E8C26A;"></div>
                    <div><strong>3</strong> - –ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π (5-10)</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #C46C38;"></div>
                    <div><strong>4</strong> - –ú–µ–¥–Ω—ã–π (4-7)</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #D9B998;"></div>
                    <div><strong>5</strong> - –ë–µ–∂–µ–≤—ã–π (6-9)</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #9C2C4A;"></div>
                    <div><strong>6</strong> - –ö—Ä–∞—Å–Ω—ã–π (3-6)</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #7A402C;"></div>
                    <div><strong>7</strong> - –ú–∞—Ö–∞–≥–æ–Ω (3-5)</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #E89438;"></div>
                    <div><strong>8</strong> - –ö–∞—Ä–∞–º–µ–ª—å–Ω—ã–π (5-8)</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #D85C28;"></div>
                    <div><strong>9</strong> - –Ø—Ä–∫–æ-–º–µ–¥–Ω—ã–π (4-6)</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #8C548C;"></div>
                    <div><strong>10</strong> - –§–∏–æ–ª–µ—Ç–æ–≤—ã–π (7-9)</div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: #f5f5f5; border-radius: 6px;">
                    <div style="width: 20px; height: 20px; border-radius: 50%; background: #3C5A8C;"></div>
                    <div><strong>12</strong> - –°–∏–Ω–∏–π (7-9)</div>
                </div>
            </div>
        </div>

        <div class="modal-section">
            <h3>üéØ –ü–†–ò–ù–¶–ò–ü –ö–û–î–ò–†–û–í–ö–ò:</h3>
            <p><strong>–§–æ—Ä–º–∞—Ç:</strong> X.Y</p>
            <p><strong>X</strong> - —É—Ä–æ–≤–µ–Ω—å –≥–ª—É–±–∏–Ω—ã (1-10): –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–≤–µ—Ç–ª–æ—Ç—É —Ü–≤–µ—Ç–∞</p>
            <p><strong>Y</strong> - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/–º–∏–∫—Å—Ç–æ–Ω (0-12): –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ—Ç—Ç–µ–Ω–æ–∫ –∏ —Ç–æ–Ω</p>
            <p><strong>–ü—Ä–∏–º–µ—Ä:</strong> 7.3 = –°–≤–µ—Ç–ª—ã–π —Ä—É—Å—ã–π (7) + –ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π –æ—Ç—Ç–µ–Ω–æ–∫ (3)</p>
            <p style="margin-top: 10px; color: #ff5722; font-weight: bold;">
                ‚ö†Ô∏è –í–∞–∂–Ω–æ: –ù–µ –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –≤–æ–∑–º–æ–∂–Ω—ã! –ö–∞–∂–¥–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–º–µ–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω —É—Ä–æ–≤–Ω–µ–π.
            </p>
        </div>`
    );
}



function showCorrectorMixCalculator() {
    showModal("‚öóÔ∏è –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–´–ô –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –° –ö–û–†–†–ï–ö–¢–û–†–û–ú",
        `<div class="modal-section">
            <h3>üéØ –†–ê–ó–ù–ò–¶–ê: –ú–ò–ö–°–¢–û–ù vs –ö–û–†–†–ï–ö–¢–û–†</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0;">
                
                <div style="padding: 20px; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); 
                     border-radius: 12px; border-left: 6px solid #2196f3;">
                    <strong style="color: #1565c0; font-size: 1.2em;">üåà –ú–ò–ö–°–¢–û–ù</strong>
                    <div style="margin-top: 10px; font-size: 0.95em;">
                        <div>‚úÖ <strong>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:</strong> –°–û–ó–î–ê–ù–ò–ï —Ü–≤–µ—Ç–∞</div>
                        <div>‚úÖ <strong>–ü—Ä–∏–º–µ—Ä:</strong> .3 = –ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π —Ç–æ–Ω</div>
                        <div>‚úÖ <strong>–î–æ–ª—è –≤ —Å–º–µ—Å–∏:</strong> 30-60%</div>
                        <div>‚úÖ <strong>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ</div>
                        <div>‚úÖ <strong>–≠—Ñ—Ñ–µ–∫—Ç:</strong> –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç—Ç–µ–Ω–æ–∫</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 8px;">
                            <strong>–§–æ—Ä–º—É–ª–∞:</strong><br>
                            <em>7.3 = 70% –æ—Å–Ω–æ–≤—ã + 30% –º–∏–∫—Å—Ç–æ–Ω–∞ .3</em>
                        </div>
                    </div>
                </div>
                
                <div style="padding: 20px; background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); 
                     border-radius: 12px; border-left: 6px solid #9c27b0;">
                    <strong style="color: #7b1fa2; font-size: 1.2em;">üé® –ö–û–†–†–ï–ö–¢–û–†</strong>
                    <div style="margin-top: 10px; font-size: 0.95em;">
                        <div>‚úÖ <strong>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:</strong> –ö–û–†–†–ï–ö–¶–ò–Ø —Ü–≤–µ—Ç–∞</div>
                        <div>‚úÖ <strong>–ü—Ä–∏–º–µ—Ä:</strong> .10 = –§–∏–æ–ª–µ—Ç–æ–≤—ã–π</div>
                        <div>‚úÖ <strong>–î–æ–ª—è –≤ —Å–º–µ—Å–∏:</strong> 1-10% (–º–∞–∫—Å!)</div>
                        <div>‚úÖ <strong>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –ù–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ–Ω–∞</div>
                        <div>‚úÖ <strong>–≠—Ñ—Ñ–µ–∫—Ç:</strong> –£–±–∏—Ä–∞–µ—Ç –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç—Ç–µ–Ω–æ–∫</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 8px;">
                            <strong>–§–æ—Ä–º—É–ª–∞:</strong><br>
                            <em>10.1 + 1–º–ª .10 = –ü–µ–ø–µ–ª –±–µ–∑ –∂–µ–ª—Ç–∏–∑–Ω—ã</em>
                        </div>
                    </div>
                </div>
                
            </div>
            
            <div style="background: #fff3e0; padding: 15px; border-radius: 10px; margin-top: 20px; border-left: 4px solid #ff9800;">
                <strong>‚ö° –ì–õ–ê–í–ù–û–ï –û–¢–õ–ò–ß–ò–ï:</strong>
                <div style="margin-top: 10px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                    <div>
                        <strong>–ú–ò–ö–°–¢–û–ù:</strong>
                        <ul style="margin: 5px 0 0 20px;">
                            <li>–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –û–¢–¢–ï–ù–û–ö</li>
                            <li>–ü—Ä–æ—Ü–µ–Ω—Ç: 30-60%</li>
                            <li>–í –Ω–∞–∑–≤–∞–Ω–∏–∏ —Ü–≤–µ—Ç–∞: 7.<span style="color: #ff5722; font-weight: bold;">3</span></li>
                        </ul>
                    </div>
                    <div>
                        <strong>–ö–û–†–†–ï–ö–¢–û–†:</strong>
                        <ul style="margin: 5px 0 0 20px;">
                            <li>–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç –§–û–ù</li>
                            <li>–ü—Ä–æ—Ü–µ–Ω—Ç: 1-10%</li>
                            <li>–î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal-section">
            <h3>üß™ –†–ê–°–ß–ï–¢ –î–û–ó–ò–†–û–í–ö–ò –ö–û–†–†–ï–ö–¢–û–†–ê:</h3>
            <div style="padding: 20px;">
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #4a148c;">
                            –û–±—ä–µ–º —Å–º–µ—Å–∏ (–≥):
                        </label>
                        <input type="number" id="mainMixVolume" value="100" min="50" max="300" step="10"
                               style="width: 100%; padding: 12px; border: 2px solid #4a148c; border-radius: 8px; font-size: 1.1em;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #ff5722;">
                            –£—Ä–æ–≤–µ–Ω—å –≤–æ–ª–æ—Å:
                        </label>
                        <select id="hairLevelCorr" style="width: 100%; padding: 12px; border: 2px solid #ff5722; border-radius: 8px; font-size: 1.1em;">
                            <option value="10">10 (–°–≤–µ—Ç–ª–µ–π—à–∏–π –±–ª–æ–Ω–¥)</option>
                            <option value="9">9 (–°–≤–µ—Ç–ª—ã–π –±–ª–æ–Ω–¥)</option>
                            <option value="8">8 (–ë–ª–æ–Ω–¥–∏–Ω)</option>
                            <option value="7" selected>7 (–°–≤–µ—Ç–ª—ã–π —Ä—É—Å—ã–π)</option>
                            <option value="6">6 (–†—É—Å—ã–π)</option>
                            <option value="5">5 (–®–∞—Ç–µ–Ω)</option>
                            <option value="4">4 (–¢–µ–º–Ω—ã–π —à–∞—Ç–µ–Ω)</option>
                            <option value="3">3 (–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π)</option>
                            <option value="2">2 (–¢–µ–º–Ω–æ-–∫–æ—Ä–∏—á–Ω–µ–≤—ã–π)</option>
                            <option value="1">1 (–ß–µ—Ä–Ω—ã–π)</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #4a148c;">
                            –ü—Ä–æ–±–ª–µ–º–∞:
                        </label>
                        <select id="correctionTask" style="width: 100%; padding: 12px; border: 2px solid #4a148c; border-radius: 8px; font-size: 1.1em;">
                            <option value="yellow">–ñ–µ–ª—Ç–∏–∑–Ω–∞ (–§–∏–æ–ª–µ—Ç–æ–≤—ã–π .10)</option>
                            <option value="orange">–û—Ä–∞–Ω–∂–µ–≤—ã–π –æ—Ç–ª–∏–≤ (–°–∏–Ω–∏–π .12)</option>
                            <option value="red">–ö—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω (–ó–µ–ª–µ–Ω—ã–π)</option>
                            <option value="blue">–°–∏–Ω–µ–≤–∞ –≤ –ø–µ–ø–ª–µ (–ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π .3)</option>
                            <option value="cold">–•–æ–ª–æ–¥–Ω—ã–π/–º–µ—Ä—Ç–≤—ã–π —Ç–æ–Ω (–ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π .3)</option>
                            <option value="bright">–Ø—Ä–∫–∞—è –º–µ–¥—å (–ö—Ä–∞—Å–Ω—ã–π .6)</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #ff5722;">
                            –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ–ª–æ—Å:
                        </label>
                        <select id="hairCondition" style="width: 100%; padding: 12px; border: 2px solid #ff5722; border-radius: 8px; font-size: 1.1em;">
                            <option value="healthy">–ó–¥–æ—Ä–æ–≤—ã–µ</option>
                            <option value="normal" selected>–ù–æ—Ä–º–∞–ª—å–Ω—ã–µ</option>
                            <option value="porous">–ü–æ—Ä–∏—Å—Ç—ã–µ</option>
                            <option value="damaged">–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ</option>
                        </select>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #9c27b0;">
                        –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã:
                    </label>
                    <select id="problemIntensity" style="width: 100%; padding: 12px; border: 2px solid #9c27b0; border-radius: 8px; font-size: 1.1em;">
                        <option value="light">–õ–µ–≥–∫–∞—è (–µ–¥–≤–∞ –∑–∞–º–µ—Ç–Ω–∞)</option>
                        <option value="medium" selected>–°—Ä–µ–¥–Ω—è—è (—è–≤–Ω–æ –≤–∏–¥–Ω–∞)</option>
                        <option value="strong">–°–∏–ª—å–Ω–∞—è (–æ—á–µ–Ω—å –≤—ã—Ä–∞–∂–µ–Ω–∞)</option>
                    </select>
                </div>
                
                <button onclick="calculateProfessionalCorrector()" 
                        style="width: 100%; padding: 15px; background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%); 
                               color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; 
                               font-size: 1.1em; margin-bottom: 20px; transition: transform 0.2s;" 
                        onmouseover="this.style.transform='scale(1.02)'" 
                        onmouseout="this.style.transform='scale(1)'">
                    ‚öóÔ∏è –†–ê–°–°–ß–ò–¢–ê–¢–¨ –ö–û–†–†–ï–ö–¢–û–†
                </button>
                
                <div id="correctorResult" style="background: linear-gradient(135deg, #e1f5fe 0%, #b3e5fc 100%); 
                    padding: 20px; border-radius: 10px; border-left: 6px solid #0288d1; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    <strong style="color: #0277bd; font-size: 1.2em;">üìä –†–ï–ó–£–õ–¨–¢–ê–¢:</strong>
                    <div style="margin-top: 15px;">
                        
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 15px;">
                            <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="color: #666; font-size: 0.9em;">–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä</div>
                                <div style="font-size: 1.8em; font-weight: 800; color: #9c27b0;" id="correctorType">.10</div>
                                <div style="color: #666; font-size: 0.9em;" id="correctorName">–§–∏–æ–ª–µ—Ç–æ–≤—ã–π</div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="color: #666; font-size: 0.9em;">–î–æ–∑–∏—Ä–æ–≤–∫–∞</div>
                                <div style="font-size: 1.8em; font-weight: 800; color: #ff5722;" id="correctorAmount">2 –º–ª</div>
                                <div style="color: #666; font-size: 0.9em;" id="correctorPercent">2%</div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="color: #666; font-size: 0.9em;">–î–∏–∞–ø–∞–∑–æ–Ω</div>
                                <div style="font-size: 1.1em; font-weight: 600; color: #009688;" id="dosageRange">1-3 –º–ª/100–≥</div>
                                <div style="color: #666; font-size: 0.9em;">–ü—Ä–æ—Ñ.</div>
                            </div>
                        </div>
                        
                        <div style="background: #fff3e0; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                            <strong>üéØ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:</strong>
                            <div id="correctorUsage" style="margin-top: 8px; font-size: 0.95em;">
                                1. –î–æ–±–∞–≤–∏—Ç—å –≤ –≥–æ—Ç–æ–≤—É—é —Å–º–µ—Å—å<br>
                                2. –¢—â–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–º–µ—à–∞—Ç—å<br>
                                3. –ù–∞–Ω–µ—Å—Ç–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è
                            </div>
                        </div>
                        
                        <div style="background: #e8f5e9; padding: 15px; border-radius: 8px;">
                            <strong>‚ö†Ô∏è –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</strong>
                            <ul style="margin: 8px 0 0 20px; font-size: 0.95em;">
                                <li id="rule1">–ú–∞–∫—Å–∏–º—É–º 10% –æ—Ç –æ–±—ä–µ–º–∞ —Å–º–µ—Å–∏</li>
                                <li id="rule2">–í—Å–µ–≥–¥–∞ –¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç-–ø—Ä—è–¥—å</li>
                                <li id="rule3">–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–º</li>
                                <li id="rule4">–ù–µ —Å–º–µ—à–∏–≤–∞—Ç—å —Å –º–∏–∫—Å—Ç–æ–Ω–æ–º –Ω–∞–ø—Ä—è–º—É—é</li>
                            </ul>
                        </div>
                        
                    </div>
                </div>
                
            </div>
        </div>

        <div class="modal-section">
            <h3>üí° –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ò–ú–ï–†–´:</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 15px;">
                
                <div style="padding: 15px; background: #f3e5f5; border-radius: 10px; border-left: 4px solid #9c27b0;">
                    <strong style="color: #7b1fa2;">üü£ –ü–µ–ø–µ–ª—å–Ω—ã–π –±–ª–æ–Ω–¥ 10.1</strong>
                    <div style="margin-top: 8px; font-size: 0.95em;">
                        <div>‚Ä¢ <strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> –ñ–µ–ª—Ç–∏–∑–Ω–∞</div>
                        <div>‚Ä¢ <strong>–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä:</strong> .10 –§–∏–æ–ª–µ—Ç–æ–≤—ã–π</div>
                        <div>‚Ä¢ <strong>–î–æ–∑–∞:</strong> 0.5-1.5 –º–ª/100–≥</div>
                        <div>‚Ä¢ <strong>–ò—Ç–æ–≥:</strong> –•–æ–ª–æ–¥–Ω—ã–π –ø–µ–ø–µ–ª</div>
                    </div>
                </div>
                
                <div style="padding: 15px; background: #e3f2fd; border-radius: 10px; border-left: 4px solid #2196f3;">
                    <strong style="color: #1565c0;">üîµ –ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π 7.3</strong>
                    <div style="margin-top: 8px; font-size: 0.95em;">
                        <div>‚Ä¢ <strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> –û—Ä–∞–Ω–∂–µ–≤—ã–π –æ—Ç–ª–∏–≤</div>
                        <div>‚Ä¢ <strong>–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä:</strong> .12 –°–∏–Ω–∏–π</div>
                        <div>‚Ä¢ <strong>–î–æ–∑–∞:</strong> 2-3 –º–ª/100–≥</div>
                        <div>‚Ä¢ <strong>–ò—Ç–æ–≥:</strong> –ß–∏—Å—Ç–æ–µ –∑–æ–ª–æ—Ç–æ</div>
                    </div>
                </div>
                
                <div style="padding: 15px; background: #e8f5e9; border-radius: 10px; border-left: 4px solid #4caf50;">
                    <strong style="color: #2e7d32;">üü¢ –ú–µ–¥–Ω—ã–π 6.4</strong>
                    <div style="margin-top: 8px; font-size: 0.95em;">
                        <div>‚Ä¢ <strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> –Ø—Ä–∫–∞—è –º–µ–¥—å</div>
                        <div>‚Ä¢ <strong>–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä:</strong> –ó–µ–ª–µ–Ω—ã–π</div>
                        <div>‚Ä¢ <strong>–î–æ–∑–∞:</strong> 3-5 –º–ª/100–≥</div>
                        <div>‚Ä¢ <strong>–ò—Ç–æ–≥:</strong> –ü—Ä–∏–≥–ª—É—à–µ–Ω–Ω–∞—è –º–µ–¥—å</div>
                    </div>
                </div>
                
                <div style="padding: 15px; background: #fff3e0; border-radius: 10px; border-left: 4px solid #ff9800;">
                    <strong style="color: #ef6c00;">üü° –ü–µ–ø–µ–ª—å–Ω—ã–π 8.1</strong>
                    <div style="margin-top: 8px; font-size: 0.95em;">
                        <div>‚Ä¢ <strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> –°–∏–Ω–µ–≤–∞</div>
                        <div>‚Ä¢ <strong>–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä:</strong> .3 –ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π</div>
                        <div>‚Ä¢ <strong>–î–æ–∑–∞:</strong> 0.5-1 –º–ª/100–≥</div>
                        <div>‚Ä¢ <strong>–ò—Ç–æ–≥:</strong> –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –ø–µ–ø–µ–ª</div>
                    </div>
                </div>
                
            </div>
            
            <div style="background: #fff3e0; padding: 15px; border-radius: 10px; margin-top: 20px; border-left: 4px solid #ff9800;">
                <strong>üéì –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–û–ï –ó–ê–ü–û–ú–ò–ù–ê–ù–ò–ï:</strong>
                <div style="margin-top: 10px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                    <div>
                        <strong>–ú–ò–ö–°–¢–û–ù = –û–¢–¢–ï–ù–û–ö</strong>
                        <div style="margin-top: 5px; font-size: 0.9em;">
                            ‚Ä¢ .1 = –ü–µ–ø–µ–ª—å–Ω—ã–π<br>
                            ‚Ä¢ .3 = –ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π<br>
                            ‚Ä¢ .4 = –ú–µ–¥–Ω—ã–π<br>
                            ‚Ä¢ .6 = –ö—Ä–∞—Å–Ω—ã–π<br>
                            ‚Ä¢ –ß–∞—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è —Ü–≤–µ—Ç–∞
                        </div>
                    </div>
                    <div>
                        <strong>–ö–û–†–†–ï–ö–¢–û–† = –ù–ï–ô–¢–†–ê–õ–ò–ó–ê–¢–û–†</strong>
                        <div style="margin-top: 5px; font-size: 0.9em;">
                            ‚Ä¢ .10 = –ü—Ä–æ—Ç–∏–≤ –∂–µ–ª—Ç–æ–≥–æ<br>
                            ‚Ä¢ .12 = –ü—Ä–æ—Ç–∏–≤ –æ—Ä–∞–Ω–∂–µ–≤–æ–≥–æ<br>
                            ‚Ä¢ –ó–µ–ª–µ–Ω—ã–π = –ü—Ä–æ—Ç–∏–≤ –∫—Ä–∞—Å–Ω–æ–≥–æ<br>
                            ‚Ä¢ –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
                        </div>
                    </div>
                </div>
            </div>
        </div>`
    );
}

function calculateProfessionalCorrector() {
    // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
    const mainVolume = parseInt(document.getElementById('mainMixVolume').value) || 100;
    const level = parseInt(document.getElementById('hairLevelCorr').value);
    const task = document.getElementById('correctionTask').value;
    const condition = document.getElementById('hairCondition').value;
    const intensity = document.getElementById('problemIntensity').value;
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ–æ–Ω –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è
    const lighteningBackgrounds = {
        10: 'yellow', 9: 'yellow', 8: 'orange', 7: 'orange',
        6: 'red', 5: 'red', 4: 'purple', 3: 'purple',
        2: 'blue', 1: 'blue'
    };
    
    const background = lighteningBackgrounds[level];
    
    // –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–æ–∑–∏—Ä–æ–≤–∫–∏ (–º–ª/100–≥)
    const professionalDosages = {
        'yellow': { // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π .10
            type: ".10", name: "–§–∏–æ–ª–µ—Ç–æ–≤—ã–π",
            min: 0.5, max: 2, typical: 1,
            rule: "–¢–æ–ª—å–∫–æ –Ω–∞ –æ—Å–≤–µ—Ç–ª–µ–Ω–Ω—ã—Ö –≤–æ–ª–æ—Å–∞—Ö!",
            warning: level < 7 ? "–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ —Ç–µ–º–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö!" : ""
        },
        'orange': { // –°–∏–Ω–∏–π .12
            type: ".12", name: "–°–∏–Ω–∏–π",
            min: 2, max: 5, typical: 3,
            rule: "–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç",
            warning: level > 8 ? "–ù–∞ –±–ª–æ–Ω–¥–µ –º–∞–∫—Å–∏–º—É–º 2–º–ª!" : ""
        },
        'red': { // –ó–µ–ª–µ–Ω—ã–π
            type: "–ó–µ–ª–µ–Ω—ã–π", name: "–ó–µ–ª–µ–Ω—ã–π",
            min: 3, max: 7, typical: 5,
            rule: "–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç-–ø—Ä—è–¥—å!",
            warning: "–ú–æ–∂–µ—Ç –¥–∞—Ç—å –≥—Ä—è–∑–Ω—ã–π –æ—Ç—Ç–µ–Ω–æ–∫"
        },
        'purple': { // –ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π .3
            type: ".3", name: "–ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π",
            min: 2, max: 4, typical: 3,
            rule: "–î–æ–±–∞–≤–ª—è—Ç—å –ø–æ –∫–∞–ø–ª—è–º",
            warning: "–£–±–∏—Ä–∞–µ—Ç —Å–∏–Ω–µ–≤—É"
        },
        'blue': { // –ú–µ–¥–Ω—ã–π .4
            type: ".4", name: "–ú–µ–¥–Ω—ã–π",
            min: 4, max: 8, typical: 6,
            rule: "–° –æ–∫–∏—Å–ª–∏—Ç–µ–ª–µ–º 12%",
            warning: "–¢–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤"
        }
    };
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–¥–∞—á—É
    let dosageInfo;
    if (task === 'yellow' || task === 'orange' || task === 'red') {
        dosageInfo = professionalDosages[task];
    } else {
        // –î–ª—è –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ–æ–Ω
        dosageInfo = professionalDosages[background];
    }
    
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–æ–∑–∏—Ä–æ–≤–∫—É
    let dosage = dosageInfo.typical;
    
    // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é
    if (condition === 'porous') dosage *= 1.3;      // +30%
    if (condition === 'damaged') dosage *= 0.6;     // -40%
    if (condition === 'healthy') dosage *= 1.2;     // +20%
    
    // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏
    if (intensity === 'light') dosage *= 0.6;       // 60%
    if (intensity === 'strong') dosage *= 1.4;      // 140%
    
    // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    dosage = Math.max(dosageInfo.min, Math.min(dosageInfo.max, dosage));
    dosage = Math.min(dosage, mainVolume * 0.10); // –ú–∞–∫—Å 10%
    
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–ª—è –æ–±—ä–µ–º–∞
    const finalDosage = Math.round((dosage * mainVolume) / 100 * 10) / 10;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    document.getElementById('correctorType').textContent = dosageInfo.type;
    document.getElementById('correctorName').textContent = dosageInfo.name;
    document.getElementById('correctorAmount').textContent = `${finalDosage} –º–ª`;
    document.getElementById('correctorPercent').textContent = `${Math.round((finalDosage/mainVolume)*100)}%`;
    document.getElementById('dosageRange').textContent = `–ü—Ä–æ—Ñ. –¥–∏–∞–ø–∞–∑–æ–Ω: ${dosageInfo.min}-${dosageInfo.max} –º–ª/100–≥`;
    
    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
    const usage = `${dosageInfo.name} –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä ${dosageInfo.type} ${finalDosage} –º–ª –Ω–∞ ${mainVolume} –≥ —Å–º–µ—Å–∏. –î–æ–±–∞–≤–∏—Ç—å –≤ –≥–æ—Ç–æ–≤—É—é —Å–º–µ—Å—å, —Ç—â–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–º–µ—à–∞—Ç—å.`;
    document.getElementById('correctorUsage').innerHTML = usage;
    
    // –ü—Ä–∞–≤–∏–ª–∞
    document.getElementById('rule1').textContent = dosageInfo.rule;
    document.getElementById('rule2').textContent = dosageInfo.warning;
    document.getElementById('rule3').textContent = `–ú–∞–∫—Å–∏–º—É–º 10% –æ—Ç —Å–º–µ—Å–∏ (${Math.round(mainVolume*0.1)} –º–ª)`;
    document.getElementById('rule4').textContent = "–í—Å–µ–≥–¥–∞ –¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç-–ø—Ä—è–¥—å –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º!";
    
    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞
    const resultDiv = document.getElementById('correctorResult');
    resultDiv.style.animation = 'none';
    setTimeout(() => {
        resultDiv.style.animation = 'highlight 0.5s ease';
    }, 10);
}


function showLighteningGuide() {
    showModal("‚ö° –ü–û–õ–ù–´–ô –ì–ò–î –ü–û –û–°–í–ï–¢–õ–ï–ù–ò–Æ",
        `<div class="modal-section">
            <h3>üéØ –§–û–ù–´ –û–°–í–ï–¢–õ–ï–ù–ò–Ø –ü–û –£–†–û–í–ù–Ø–ú:</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 15px 0;">
                
                <div style="padding: 15px; background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%); border-radius: 10px; border-left: 6px solid #ffeb3b; border-bottom: 3px solid #fbc02d;">
                    <strong style="color: #f57f17; font-size: 1.1em;">üü° –£–†–û–í–ù–ò 10-9</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üé® <strong>–§–æ–Ω:</strong> –ñ–ï–õ–¢–´–ô (–∂–µ–ª—Ç–æ–∫)</div>
                        <div>üéØ <strong>–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä:</strong> –§–ò–û–õ–ï–¢–û–í–´–ô (.10)</div>
                        <div>üìè <strong>–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</strong> 1.5-3% (20 vol)</div>
                        <div>‚è±Ô∏è <strong>–í—Ä–µ–º—è:</strong> 15-25 –º–∏–Ω</div>
                        <div>üí° <strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</strong> –¢–æ–ª—å–∫–æ —Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                    </div>
                </div>
                
                <div style="padding: 15px; background: linear-gradient(135deg, #ffcc80 0%, #ffb74d 100%); border-radius: 10px; border-left: 6px solid #ff9800; border-bottom: 3px solid #f57c00;">
                    <strong style="color: #e65100; font-size: 1.1em;">üü† –£–†–û–í–ù–ò 8-7</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üé® <strong>–§–æ–Ω:</strong> –û–†–ê–ù–ñ–ï–í–´–ô (–∞–ø–µ–ª—å—Å–∏–Ω)</div>
                        <div>üéØ <strong>–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä:</strong> –°–ò–ù–ò–ô (.12)</div>
                        <div>üìè <strong>–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</strong> 6% (20 vol)</div>
                        <div>‚è±Ô∏è <strong>–í—Ä–µ–º—è:</strong> 30-40 –º–∏–Ω</div>
                        <div>üí° <strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</strong> –ö–æ–Ω—Ç—Ä–æ–ª—å –æ—Ä–∞–Ω–∂–µ–≤–æ–≥–æ</div>
                    </div>
                </div>
                
                <div style="padding: 15px; background: linear-gradient(135deg, #ff8a80 0%, #ff5252 100%); border-radius: 10px; border-left: 6px solid #f44336; border-bottom: 3px solid #d32f2f;">
                    <strong style="color: #b71c1c; font-size: 1.1em;">üî¥ –£–†–û–í–ù–ò 6-5</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üé® <strong>–§–æ–Ω:</strong> –ö–†–ê–°–ù–´–ô (–∫–ª—É–±–Ω–∏–∫–∞)</div>
                        <div>üéØ <strong>–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä:</strong> –ó–ï–õ–ï–ù–´–ô</div>
                        <div>üìè <strong>–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</strong> 9% (30 vol)</div>
                        <div>‚è±Ô∏è <strong>–í—Ä–µ–º—è:</strong> 40-50 –º–∏–Ω</div>
                        <div>üí° <strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</strong> –°–ª–æ–∂–Ω–∞—è –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è</div>
                    </div>
                </div>
                
                <div style="padding: 15px; background: linear-gradient(135deg, #ce93d8 0%, #ba68c8 100%); border-radius: 10px; border-left: 6px solid #9c27b0; border-bottom: 3px solid #7b1fa2;">
                    <strong style="color: #4a148c; font-size: 1.1em;">üü£ –£–†–û–í–ù–ò 4-3</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üé® <strong>–§–æ–Ω:</strong> –§–ò–û–õ–ï–¢–û–í–´–ô (–±–∞–∫–ª–∞–∂–∞–Ω)</div>
                        <div>üéØ <strong>–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä:</strong> –ñ–ï–õ–¢–´–ô</div>
                        <div>üìè <strong>–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</strong> 12% (40 vol)</div>
                        <div>‚è±Ô∏è <strong>–í—Ä–µ–º—è:</strong> 50-60 –º–∏–Ω</div>
                        <div>üí° <strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</strong> –ú–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω–æ–µ –æ—Å–≤–µ—Ç–ª–µ–Ω–∏–µ</div>
                    </div>
                </div>
                
                <div style="padding: 15px; background: linear-gradient(135deg, #90caf9 0%, #64b5f6 100%); border-radius: 10px; border-left: 6px solid #2196f3; border-bottom: 3px solid #1976d2;">
                    <strong style="color: #0d47a1; font-size: 1.1em;">üîµ –£–†–û–í–ù–ò 2-1</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üé® <strong>–§–æ–Ω:</strong> –°–ò–ù–ò–ô (—á–µ—Ä–Ω–∏–∫–∞)</div>
                        <div>üéØ <strong>–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä:</strong> –û–†–ê–ù–ñ–ï–í–´–ô</div>
                        <div>üìè <strong>–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</strong> 12% (40 vol)</div>
                        <div>‚è±Ô∏è <strong>–í—Ä–µ–º—è:</strong> 60-70 –º–∏–Ω</div>
                        <div>üí° <strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</strong> –¢–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤</div>
                    </div>
                </div>
                
            </div>
        </div>

        <div class="modal-section">
            <h3>üìä –≠–¢–ê–ü–´ –û–°–í–ï–¢–õ–ï–ù–ò–Ø:</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin: 15px 0;">
                
                <div style="padding: 15px; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-radius: 10px; border-left: 6px solid #4caf50; border-bottom: 3px solid #388e3c;">
                    <strong style="color: #1b5e20; font-size: 1.1em;">üü¢ –£—Ä–æ–≤–Ω–∏ 1-3 (–¢–µ–º–Ω—ã–µ)</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üìÖ <strong>–ü—Ä–æ—Ü–µ–¥—É—Ä—ã:</strong> 3-4 —ç—Ç–∞–ø–∞</div>
                        <div>‚è≥ <strong>–ò–Ω—Ç–µ—Ä–≤–∞–ª:</strong> 3-4 –Ω–µ–¥–µ–ª–∏</div>
                        <div>‚ö° <strong>–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</strong> 12% ‚Üí 9% ‚Üí 6%</div>
                        <div>üéØ <strong>–¶–µ–ª—å:</strong> –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ</div>
                        <div>‚ö†Ô∏è <strong>–†–∏—Å–∫–∏:</strong> –õ–æ–º–∫–æ—Å—Ç—å, –∂–µ–ª—Ç–∏–∑–Ω–∞</div>
                    </div>
                </div>
                
                <div style="padding: 15px; background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); border-radius: 10px; border-left: 6px solid #ff9800; border-bottom: 3px solid #f57c00;">
                    <strong style="color: #e65100; font-size: 1.1em;">üü† –£—Ä–æ–≤–Ω–∏ 4-6 (–°—Ä–µ–¥–Ω–∏–µ)</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üìÖ <strong>–ü—Ä–æ—Ü–µ–¥—É—Ä—ã:</strong> 1-2 —ç—Ç–∞–ø–∞</div>
                        <div>‚è≥ <strong>–ò–Ω—Ç–µ—Ä–≤–∞–ª:</strong> 2-3 –Ω–µ–¥–µ–ª–∏</div>
                        <div>‚ö° <strong>–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</strong> 9% ‚Üí 6%</div>
                        <div>üéØ <strong>–¶–µ–ª—å:</strong> –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ –æ—Å–≤–µ—Ç–ª–µ–Ω–∏–µ</div>
                        <div>‚ö†Ô∏è <strong>–†–∏—Å–∫–∏:</strong> –ö—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω</div>
                    </div>
                </div>
                
                <div style="padding: 15px; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border-radius: 10px; border-left: 6px solid #2196f3; border-bottom: 3px solid #1976d2;">
                    <strong style="color: #0d47a1; font-size: 1.1em;">üîµ –£—Ä–æ–≤–Ω–∏ 7-8 (–°–≤–µ—Ç–ª—ã–µ)</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üìÖ <strong>–ü—Ä–æ—Ü–µ–¥—É—Ä—ã:</strong> 1 —ç—Ç–∞–ø</div>
                        <div>‚è≥ <strong>–ò–Ω—Ç–µ—Ä–≤–∞–ª:</strong> 4-6 –Ω–µ–¥–µ–ª—å</div>
                        <div>‚ö° <strong>–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</strong> 6%</div>
                        <div>üéØ <strong>–¶–µ–ª—å:</strong> –¢–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–Ω–∞</div>
                        <div>‚ö†Ô∏è <strong>–†–∏—Å–∫–∏:</strong> –û—Ä–∞–Ω–∂–µ–≤—ã–π —Ñ–æ–Ω</div>
                    </div>
                </div>
                
                <div style="padding: 15px; background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); border-radius: 10px; border-left: 6px solid #9c27b0; border-bottom: 3px solid #7b1fa2;">
                    <strong style="color: #4a148c; font-size: 1.1em;">üü£ –£—Ä–æ–≤–Ω–∏ 9-10 (–ë–ª–æ–Ω–¥)</strong>
                    <div style="font-size: 0.9em; margin-top: 8px;">
                        <div>üìÖ <strong>–ü—Ä–æ—Ü–µ–¥—É—Ä—ã:</strong> –¢–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                        <div>‚è≥ <strong>–ò–Ω—Ç–µ—Ä–≤–∞–ª:</strong> 4-8 –Ω–µ–¥–µ–ª—å</div>
                        <div>‚ö° <strong>–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</strong> 1.5-3%</div>
                        <div>üéØ <strong>–¶–µ–ª—å:</strong> –ö–æ—Ä—Ä–µ–∫—Ü–∏—è —Ç–æ–Ω–∞</div>
                        <div>‚ö†Ô∏è <strong>–†–∏—Å–∫–∏:</strong> –ñ–µ–ª—Ç–∏–∑–Ω–∞</div>
                    </div>
                </div>
                
            </div>
        </div>




        <div class="modal-section">
            <h3>üí° –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –°–û–í–ï–¢–´ –ü–ê–†–ò–ö–ú–ê–•–ï–†–û–í:</h3>
            
            <div style="background: #fff3e0; padding: 15px; border-radius: 10px; border-left: 5px solid #ff9800; margin-bottom: 10px;">
                <strong>‚ö° –¢–ï–•–ù–ò–ö–ê –ë–ï–ó–û–ü–ê–°–ù–û–ì–û –û–°–í–ï–¢–õ–ï–ù–ò–Ø:</strong>
                <ul style="margin: 10px 0 0 20px;">
                    <li><strong>–û—Ç –∫–æ–Ω—Ü–æ–≤ –∫ –∫–æ—Ä–Ω—è–º:</strong> –ö–æ—Ä–Ω–∏ –Ω–∞–Ω–æ—Å–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏</li>
                    <li><strong>–ö–æ–Ω—Ç—Ä–æ–ª—å —Ç–æ–ª—â–∏–Ω—ã:</strong> –¢–æ–Ω–∫–∏–µ –≤–æ–ª–æ—Å—ã - –º–µ–Ω—å—à–µ –æ–∫–∏—Å–ª–∏—Ç–µ–ª—è</li>
                    <li><strong>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</strong> –¢–µ–ø–ª–æ —É—Å–∫–æ—Ä—è–µ—Ç, —Ö–æ–ª–æ–¥ –∑–∞–º–µ–¥–ª—è–µ—Ç</li>
                    <li><strong>–¢–µ—Å—Ç-–ø—Ä—è–¥—å:</strong> –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø—Ä—è–¥–∏</li>
                    <li><strong>–ò–Ω—Ç–µ—Ä–≤–∞–ª—ã:</strong> –ù–µ –æ—Å–≤–µ—Ç–ª—è—Ç—å —á–∞—â–µ 1 —Ä–∞–∑–∞ –≤ 3 –Ω–µ–¥–µ–ª–∏</li>
                </ul>
            </div>
            
            <div style="background: #f3e5f5; padding: 15px; border-radius: 10px; border-left: 5px solid #9c27b0; margin-bottom: 10px;">
                <strong>üéØ –ö–û–†–†–ï–ö–¶–ò–Ø –û–®–ò–ë–û–ö:</strong>
                <ul style="margin: 10px 0 0 20px;">
                    <li><strong>–ñ–µ–ª—Ç–∏–∑–Ω–∞:</strong> –§–∏–æ–ª–µ—Ç–æ–≤—ã–π —à–∞–º–ø—É–Ω—å + —Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ .10</li>
                    <li><strong>–û—Ä–∞–Ω–∂–µ–≤—ã–π —Ñ–æ–Ω:</strong> –°–∏–Ω–∏–π –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä + –ø–µ—Ä–µ–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ</li>
                    <li><strong>–ö—Ä–∞—Å–Ω—ã–π –æ—Ç–ª–∏–≤:</strong> –ó–µ–ª–µ–Ω—ã–π –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä –∏–ª–∏ —Å–º—ã–≤–∫–∞</li>
                    <li><strong>–ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å:</strong> –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ –±–æ–ª–µ–µ —Å–≤–µ—Ç–ª—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤</li>
                    <li><strong>–ü–µ—Ä–µ–æ—Å–≤–µ—Ç–ª–µ–Ω–∏–µ:</strong> –ö–µ—Ä–∞—Ç–∏–Ω–æ–≤–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</li>
                </ul>
            </div>
            
            <div style="background: #e8f5e9; padding: 15px; border-radius: 10px; border-left: 5px solid #4caf50;">
                <strong>üìä –¢–ê–ë–õ–ò–¶–ê –í–û–õ–Æ–ú–û–í (–û–ö–ò–°–õ–ò–¢–ï–õ–ï–ô):</strong>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-top: 10px; text-align: center;">
                    <div style="padding: 8px; background: #fff3e0; border-radius: 6px;">
                        <strong>1.5-3%</strong><br>5-10 vol<br>–¢–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
                    </div>
                    <div style="padding: 8px; background: #ffe0b2; border-radius: 6px;">
                        <strong>6%</strong><br>20 vol<br>–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ –Ω–∞ 1-2 —Ç–æ–Ω–∞
                    </div>
                    <div style="padding: 8px; background: #ffcc80; border-radius: 6px;">
                        <strong>9%</strong><br>30 vol<br>–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ –Ω–∞ 2-3 —Ç–æ–Ω–∞
                    </div>
                    <div style="padding: 8px; background: #ffb74d; border-radius: 6px;">
                        <strong>12%</strong><br>40 vol<br>–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ –Ω–∞ 3-4 —Ç–æ–Ω–∞
                    </div>
                </div>
            </div>
            
            <div style="background: #ffebee; padding: 15px; border-radius: 10px; border-left: 5px solid #f44336; margin-top: 15px;">
                <strong>‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò:</strong>
                <ul style="margin: 10px 0 0 20px;">
                    <li>–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å 12% –æ–∫–∏—Å–ª–∏—Ç–µ–ª—å –Ω–∞ –∫–æ—Ä–Ω—è—Ö</li>
                    <li>–ù–µ –æ—Å–≤–µ—Ç–ª—è—Ç—å —Ä–∞–Ω–µ–µ –æ–∫—Ä–∞—à–µ–Ω–Ω—ã–µ –≤–æ–ª–æ—Å—ã –≤—ã—Å–æ–∫–∏–º %</li>
                    <li>–í—Å–µ–≥–¥–∞ –¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç –Ω–∞ –∞–ª–ª–µ—Ä–≥–∏—é –∑–∞ 48 —á–∞—Å–æ–≤</li>
                    <li>–ù–µ —Å–º–µ—à–∏–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –º–∞—Ä–∫–∏ –∫—Ä–∞—Å–∏—Ç–µ–ª–µ–π –∏ –æ–∫–∏—Å–ª–∏—Ç–µ–ª–µ–π</li>
                    <li>–ü—Ä–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –≤–æ–ª–æ—Å–∞—Ö - —Ç–æ–ª—å–∫–æ —Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</li>
                </ul>
            </div>
        </div>`
    );
}





function showHairDiagnostics() {
    showModal("üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –°–û–°–¢–û–Ø–ù–ò–Ø –í–û–õ–û–°",
        `<div class="modal-section">
            <h3>üìä –¢–ï–°–¢ –ù–ê –ü–û–†–ò–°–¢–û–°–¢–¨:</h3>
            <div style="padding: 20px;">
                <div style="background: #e3f2fd; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                    <strong style="color: #1565c0;">üß™ –ú–µ—Ç–æ–¥ "–í–æ–¥–Ω—ã–π —Ç–µ—Å—Ç":</strong>
                    <ol style="margin: 10px 0 0 20px;">
                        <li>–í–æ–∑—å–º–∏—Ç–µ —á–∏—Å—Ç—ã–π —Å—É—Ö–æ–π –≤–æ–ª–æ—Å (–±–µ–∑ —É–∫–ª–∞–¥–∫–∏)</li>
                        <li>–ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤ —Å—Ç–∞–∫–∞–Ω —Å –≤–æ–¥–æ–π –∫–æ–º–Ω–∞—Ç–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã</li>
                        <li>–û—Ü–µ–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã</li>
                    </ol>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 20px 0;">
                    <div style="padding: 20px; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); 
                         border-radius: 12px; border-left: 6px solid #4caf50; text-align: center;">
                        <div style="font-size: 2.5em; margin-bottom: 10px;">‚Üë</div>
                        <strong style="color: #2e7d32; font-size: 1.2em;">–ù–ò–ó–ö–ê–Ø</strong>
                        <div style="margin-top: 10px; font-size: 0.9em;">
                            <div>‚Ä¢ –ü–ª–∞–≤–∞–µ—Ç –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏</div>
                            <div>‚Ä¢ –ü–ª–æ—Ö–æ –≤–ø–∏—Ç—ã–≤–∞–µ—Ç</div>
                            <div>‚Ä¢ –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è</div>
                            <div style="margin-top: 10px;">
                                <strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong><br>
                                6-9% –æ–∫–∏—Å–ª–∏—Ç–µ–ª—å<br>
                                –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –º—ã—Ç—å–µ
                            </div>
                        </div>
                    </div>
                    
                    <div style="padding: 20px; background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); 
                         border-radius: 12px; border-left: 6px solid #ff9800; text-align: center;">
                        <div style="font-size: 2.5em; margin-bottom: 10px;">‚Üí</div>
                        <strong style="color: #ef6c00; font-size: 1.2em;">–°–†–ï–î–ù–Ø–Ø</strong>
                        <div style="margin-top: 10px; font-size: 0.9em;">
                            <div>‚Ä¢ –ü–ª–∞–≤–∞–µ—Ç –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ</div>
                            <div>‚Ä¢ –ù–æ—Ä–º–∞–ª—å–Ω–æ –≤–ø–∏—Ç—ã–≤–∞–µ—Ç</div>
                            <div>‚Ä¢ –•–æ—Ä–æ—à–æ –æ–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è</div>
                            <div style="margin-top: 10px;">
                                <strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong><br>
                                –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã<br>
                                –õ—é–±—ã–µ –∫—Ä–∞—Å–∏—Ç–µ–ª–∏
                            </div>
                        </div>
                    </div>
                    
                    <div style="padding: 20px; background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%); 
                         border-radius: 12px; border-left: 6px solid #f44336; text-align: center;">
                        <div style="font-size: 2.5em; margin-bottom: 10px;">‚Üì</div>
                        <strong style="color: #c62828; font-size: 1.2em;">–í–´–°–û–ö–ê–Ø</strong>
                        <div style="margin-top: 10px; font-size: 0.9em;">
                            <div>‚Ä¢ –¢–æ–Ω–µ—Ç –Ω–∞ –¥–Ω–æ</div>
                            <div>‚Ä¢ –ë—ã—Å—Ç—Ä–æ –≤–ø–∏—Ç—ã–≤–∞–µ—Ç</div>
                            <div>‚Ä¢ –ë—ã—Å—Ç—Ä–æ –æ–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è</div>
                            <div style="margin-top: 10px;">
                                <strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong><br>
                                1.5-3% –æ–∫–∏—Å–ª–∏—Ç–µ–ª—å<br>
                                –ö–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è –≤—ã–¥–µ—Ä–∂–∫–∏
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal-section">
            <h3>üéØ –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –¢–ò–ü–ê –í–û–õ–û–°:</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0;">
                
                <div style="padding: 15px; background: #f3e5f5; border-radius: 10px; border-left: 5px solid #9c27b0;">
                    <strong style="color: #7b1fa2;">üë©‚Äçü¶∞ –ù–û–†–ú–ê–õ–¨–ù–´–ï –í–û–õ–û–°–´</strong>
                    <ul style="margin: 10px 0 0 20px; font-size: 0.9em;">
                        <li>–ë–ª–µ—Å—Ç—è—â–∏–µ, —ç–ª–∞—Å—Ç–∏—á–Ω—ã–µ</li>
                        <li>–õ–µ–≥–∫–æ —Ä–∞—Å—á–µ—Å—ã–≤–∞—é—Ç—Å—è</li>
                        <li>–•–æ—Ä–æ—à–æ –¥–µ—Ä–∂–∞—Ç —É–∫–ª–∞–¥–∫—É</li>
                        <li>–ù–µ –ø—É—à–∞—Ç—Å—è</li>
                        <li><strong>–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ:</strong> –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ</li>
                    </ul>
                </div>
                
                <div style="padding: 15px; background: #e3f2fd; border-radius: 10px; border-left: 5px solid #2196f3;">
                    <strong style="color: #1565c0;">üí¶ –ñ–ò–†–ù–´–ï –í–û–õ–û–°–´</strong>
                    <ul style="margin: 10px 0 0 20px; font-size: 0.9em;">
                        <li>–ë—ã—Å—Ç—Ä–æ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –∂–∏—Ä–Ω—ã–º–∏</li>
                        <li>–¢—è–∂–µ–ª—ã–µ, —Å–ª–∏–ø–∞—é—Ç—Å—è</li>
                        <li>–¢—É—Å–∫–ª—ã–π –±–ª–µ—Å–∫</li>
                        <li><strong>–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ:</strong> –ü–µ—Ä–µ–¥ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ–º –≤—ã–º—ã—Ç—å</li>
                    </ul>
                </div>
                
                <div style="padding: 15px; background: #fff3e0; border-radius: 10px; border-left: 5px solid #ff9800;">
                    <strong style="color: #ef6c00;">üçÇ –°–£–•–ò–ï –í–û–õ–û–°–´</strong>
                    <ul style="margin: 10px 0 0 20px; font-size: 0.9em;">
                        <li>–¢—É—Å–∫–ª—ã–µ, –ª–æ–º–∫–∏–µ</li>
                        <li>–°–∏–ª—å–Ω–æ –ø—É—à–∞—Ç—Å—è</li>
                        <li>–ö–æ–Ω—á–∏–∫–∏ —Å–µ–∫—É—Ç—Å—è</li>
                        <li><strong>–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ:</strong> –ë–µ–∑–∞–º–º–∏–∞—á–Ω—ã–µ –∫—Ä–∞—Å–∏—Ç–µ–ª–∏</li>
                    </ul>
                </div>
                
                <div style="padding: 15px; background: #ffebee; border-radius: 10px; border-left: 5px solid #f44336;">
                    <strong style="color: #d32f2f;">üî• –ü–û–í–†–ï–ñ–î–ï–ù–ù–´–ï –í–û–õ–û–°–´</strong>
                    <ul style="margin: 10px 0 0 20px; font-size: 0.9em;">
                        <li>–°–∏–ª—å–Ω–æ –ø–æ—Ä–∏—Å—Ç—ã–µ</li>
                        <li>–û—á–µ–Ω—å –ª–æ–º–∫–∏–µ</li>
                        <li>–ü–ª–æ—Ö–æ –¥–µ—Ä–∂–∞—Ç —Ü–≤–µ—Ç</li>
                        <li><strong>–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ:</strong> –¢–æ–ª—å–∫–æ —Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</li>
                    </ul>
                </div>
                
            </div>
        </div>

        <div class="modal-section">
            <h3>‚ö° –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –°–û–í–ï–¢–´:</h3>
            
            <div style="background: #e8f5e9; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                <strong style="color: #2e7d32;">‚úÖ –î–õ–Ø –ù–ò–ó–ö–û–ô –ü–û–†–ò–°–¢–û–°–¢–ò:</strong>
                <ul style="margin: 10px 0 0 20px;">
                    <li>–ú—ã—Ç—å –≥–æ–ª–æ–≤—É –∑–∞ –¥–µ–Ω—å –¥–æ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è</li>
                    <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 9% –æ–∫–∏—Å–ª–∏—Ç–µ–ª—å</li>
                    <li>–£–≤–µ–ª–∏—á–∏—Ç—å –≤—Ä–µ–º—è –≤—ã–¥–µ—Ä–∂–∫–∏ –Ω–∞ 5-10 –º–∏–Ω—É—Ç</li>
                    <li>–ü—Ä–∏–º–µ–Ω—è—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏ "—Ä–∞—Å—Ç—è–∂–∫–∏" —Ü–≤–µ—Ç–∞</li>
                </ul>
            </div>
            
            <div style="background: #fff3e0; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                <strong style="color: #ef6c00;">‚ö†Ô∏è –î–õ–Ø –í–´–°–û–ö–û–ô –ü–û–†–ò–°–¢–û–°–¢–ò:</strong>
                <ul style="margin: 10px 0 0 20px;">
                    <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 1.5-3% –æ–∫–∏—Å–ª–∏—Ç–µ–ª—å</li>
                    <li>–°–æ–∫—Ä–∞—Ç–∏—Ç—å –≤—Ä–µ–º—è –≤—ã–¥–µ—Ä–∂–∫–∏</li>
                    <li>–î–µ–ª–∞—Ç—å —Ç–µ—Å—Ç-–ø—Ä—è–¥—å –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç</li>
                    <li>–ü–µ—Ä–µ–¥ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ–º –Ω–∞–Ω–µ—Å—Ç–∏ –∑–∞—â–∏—Ç—É</li>
                </ul>
            </div>
            
            <div style="background: #f3e5f5; padding: 15px; border-radius: 10px;">
                <strong style="color: #7b1fa2;">üíé –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ü–û–°–õ–ï –û–ö–†–ê–®–ò–í–ê–ù–ò–Ø:</strong>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px;">
                    <div>
                        <strong>–ö–µ—Ä–∞—Ç–∏–Ω–æ–≤—ã–µ –º–∞—Å–∫–∏</strong><br>
                        1-2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é
                    </div>
                    <div>
                        <strong>–¢–µ—Ä–º–æ–∑–∞—â–∏—Ç–∞</strong><br>
                        –ü–µ—Ä–µ–¥ —É–∫–ª–∞–¥–∫–æ–π
                    </div>
                    <div>
                        <strong>SPF –¥–ª—è –≤–æ–ª–æ—Å</strong><br>
                        –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–æ–ª–Ω—Ü–∞
                    </div>
                    <div>
                        <strong>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —É—Ö–æ–¥</strong><br>
                        –í —Å–∞–ª–æ–Ω–µ –∫–∞–∂–¥—ã–µ 2 –º–µ—Å
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #4a148c 0%, #6a1b9a 100%); 
                 color: white; border-radius: 10px; text-align: center;">
                <strong>üéØ –ì–õ–ê–í–ù–û–ï –ü–†–ê–í–ò–õ–û:</strong>
                <div style="font-size: 1.2em; margin-top: 10px;">
                    –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ —Ç–µ—Å—Ç-–ø—Ä—è–¥—å –ø–µ—Ä–µ–¥ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ–º!<br>
                    –û—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–º–∏ –≤–æ–ª–æ—Å–∞–º–∏.
                </div>
            </div>
        </div>`
    );
}



// ============================================
// –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–´–ô –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –û–ö–†–ê–®–ò–í–ê–ù–ò–Ø –í–û–õ–û–°
// ============================================

let selectedHairType = 'virgin';
let selectedProductType = 'auto';
let selectedOxidizerType = 'auto';
let selectedOxidizerValue = null;
let selectedProcedureType = 'auto';
let selectedCorrectorRule = 'rule10';

// –¢–ê–ë–õ–ò–¶–ê –ù–ï–ô–¢–†–ê–õ–ò–ó–ê–¶–ò–ò –û–¢–¢–ï–ù–ö–û–í
const NEUTRALIZATION_TABLE = {
    green: { name: "–ó–µ–ª–µ–Ω—ã–π", corrector: "–ö—Ä–∞—Å–Ω—ã–π (0/45)", icon: "üü¢" },
    yellow: { name: "–ñ–µ–ª—Ç—ã–π", corrector: "–§–∏–æ–ª–µ—Ç–æ–≤—ã–π (0/66)", icon: "üü°" },
    orange: { name: "–û—Ä–∞–Ω–∂–µ–≤—ã–π", corrector: "–°–∏–Ω–∏–π (0/22)", icon: "üü†" },
    red: { name: "–ö—Ä–∞—Å–Ω—ã–π", corrector: "–ó–µ–ª–µ–Ω—ã–π (0/33)", icon: "üî¥" },
    blue: { name: "–°–∏–Ω–∏–π", corrector: "–û—Ä–∞–Ω–∂–µ–≤—ã–π", icon: "üîµ" }
};

// –¢–ê–ë–õ–ò–¶–ê –†–ê–°–ß–ï–¢–ê –ö–û–†–†–ï–ö–¢–û–†–ê
const CORRECTOR_CALCULATION_TABLE = {
    10: {
        1: { cm: 9, g: 4.5, formula: "10 - 1 = 9 —Å–º" },
        2: { cm: 8, g: 4.0, formula: "10 - 2 = 8 —Å–º" },
        3: { cm: 7, g: 3.5, formula: "10 - 3 = 7 —Å–º" },
        4: { cm: 6, g: 3.0, formula: "10 - 4 = 6 —Å–º" },
        5: { cm: 5, g: 2.5, formula: "10 - 5 = 5 —Å–º" },
        6: { cm: 4, g: 2.0, formula: "10 - 6 = 4 —Å–º" },
        7: { cm: 3, g: 1.5, formula: "10 - 7 = 3 —Å–º" },
        8: { cm: 2, g: 1.0, formula: "10 - 8 = 2 —Å–º" },
        9: { cm: 1, g: 0.5, formula: "10 - 9 = 1 —Å–º" },
        10: { cm: 1, g: 0.5, formula: "10 - 10 = 1 —Å–º" }
    },
    11: {
        1: { cm: 10, g: 5.0, formula: "11 - 1 = 10 —Å–º" },
        2: { cm: 9, g: 4.5, formula: "11 - 2 = 9 —Å–º" },
        3: { cm: 8, g: 4.0, formula: "11 - 3 = 8 —Å–º" },
        4: { cm: 7, g: 3.5, formula: "11 - 4 = 7 —Å–º" },
        5: { cm: 6, g: 3.0, formula: "11 - 5 = 6 —Å–º" },
        6: { cm: 5, g: 2.5, formula: "11 - 6 = 5 —Å–º" },
        7: { cm: 4, g: 2.0, formula: "11 - 7 = 4 —Å–º" },
        8: { cm: 3, g: 1.5, formula: "11 - 8 = 3 —Å–º" },
        9: { cm: 2, g: 1.0, formula: "11 - 9 = 2 —Å–º" },
        10: { cm: 1, g: 0.5, formula: "11 - 10 = 1 —Å–º" },
        11: { cm: 0, g: 0.0, formula: "11 - 11 = 0 —Å–º" }
    }
};

// –¢–ò–ü–´ –ü–†–û–î–£–ö–¢–û–í
const PRODUCT_TYPES = {
    permanent: { 
        name: "–ü–µ—Ä–º–∞–Ω–µ–Ω—Ç–Ω–∞—è –∫—Ä–∞—Å–∫–∞", 
        icon: "üé®", 
        color: "#9c27b0",
        description: "–î–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è, –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è –¥–æ 4 —Ç–æ–Ω–æ–≤",
        ratios: {
            "1.5%": "1:1", "3%": "1:1", "4.5%": "1:1", 
            "6%": "1:1", "7.5%": "1:1", "9%": "1:1", "12%": "1:1"
        }
    },
    powder: { 
        name: "–û–±–µ—Å—Ü–≤–µ—á–∏–≤–∞—é—â–∏–π –ø–æ—Ä–æ—à–æ–∫", 
        icon: "‚öóÔ∏è", 
        color: "#ff9800",
        description: "–î–ª—è —Å–∏–ª—å–Ω–æ–≥–æ –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è –∏ –æ–±–µ—Å—Ü–≤–µ—á–∏–≤–∞–Ω–∏—è",
        ratios: {
            "3%": "1:2", "4.5%": "1:2", "6%": "1:2", 
            "7.5%": "1:2", "9%": "1:2", "12%": "1:2"
        }
    },
    special_blond: { 
        name: "–°–ø–µ—Ü–±–ª–æ–Ω–¥", 
        icon: "‚ú®", 
        color: "#ffeb3b",
        description: "–î–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è",
        ratios: {
            "6%": "1:2", "7.5%": "1:2", "9%": "1:2", "12%": "1:2"
        }
    },
    toner: { 
        name: "–¢–æ–Ω–∏—Ä—É—é—â–∞—è –∫—Ä–∞—Å–∫–∞", 
        icon: "üíé", 
        color: "#2196f3",
        description: "–î–ª—è –ø–∞—Å—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç—Ç–µ–Ω–∫–æ–≤ –∏ —Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è",
        ratios: {
            "1.5%": "1:1", "3%": "1:1", "4.5%": "1:1"
        }
    },
    auto: { 
        name: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä", 
        icon: "ü§ñ", 
        color: "#4a148c" 
    }
};

// –¢–ò–ü–´ –ü–†–û–¶–ï–î–£–†
const PROCEDURE_TYPES = {
    darkening: { name: "–ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ", icon: "‚¨áÔ∏è", color: "#1976d2" },
    ton_in_ton: { name: "–¢–æ–Ω –≤ —Ç–æ–Ω", icon: "üîÑ", color: "#9c27b0" },
    gray_coverage: { name: "–°–µ–¥—ã–µ –≤–æ–ª–æ—Å—ã", icon: "üë¥", color: "#607d8b" },
    lightening: { name: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ", icon: "‚ö°", color: "#ff9800" },
    bleaching: { name: "–û–±–µ—Å—Ü–≤–µ—á–∏–≤–∞–Ω–∏–µ", icon: "üí•", color: "#ff5722" },
    toning: { name: "–¢–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ", icon: "üé®", color: "#e91e63" },
    auto: { name: "–ê–≤—Ç–æ–ø–æ–¥–±–æ—Ä", icon: "ü§ñ", color: "#4a148c" }
};

// –§–û–ù–´ –û–°–í–ï–¢–õ–ï–ù–ò–Ø –° –ù–ï–ô–¢–†–ê–õ–ò–ó–ê–¶–ò–ï–ô
const LIGHTENING_BACKGROUNDS = {
    1: { 
        name: "–ß–µ—Ä–Ω—ã–π", 
        pigment: "–¢–µ–º–Ω–æ-–±—É—Ä—ã–π",
        unwantedTones: ["–ö—Ä–∞—Å–Ω—ã–π", "–û—Ä–∞–Ω–∂–µ–≤—ã–π"],
        neutralization: "–°–∏–Ω–∏–π (0/22) + –§–∏–æ–ª–µ—Ç–æ–≤—ã–π (0/66)"
    },
    2: { 
        name: "–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π", 
        pigment: "–¢–µ–º–Ω–æ-–±—É—Ä—ã–π",
        unwantedTones: ["–û—Ä–∞–Ω–∂–µ–≤—ã–π", "–ö—Ä–∞—Å–Ω—ã–π"],
        neutralization: "–°–∏–Ω–∏–π (0/22) + –§–∏–æ–ª–µ—Ç–æ–≤—ã–π (0/66)"
    },
    3: { 
        name: "–¢–µ–º–Ω—ã–π —à–∞—Ç–µ–Ω", 
        pigment: "–ë—É—Ä–æ-–∫—Ä–∞—Å–Ω—ã–π",
        unwantedTones: ["–û—Ä–∞–Ω–∂–µ–≤—ã–π", "–ñ–µ–ª—Ç—ã–π"],
        neutralization: "–ó–µ–ª–µ–Ω—ã–π (0/33) + –°–∏–Ω–∏–π (0/22)"
    },
    4: { 
        name: "–®–∞—Ç–µ–Ω", 
        pigment: "–¢–µ–º–Ω–æ-–∫—Ä–∞—Å–Ω—ã–π",
        unwantedTones: ["–ö—Ä–∞—Å–Ω—ã–π", "–û—Ä–∞–Ω–∂–µ–≤—ã–π"],
        neutralization: "–ó–µ–ª–µ–Ω—ã–π (0/33)"
    },
    5: { 
        name: "–°–≤–µ—Ç–ª—ã–π —à–∞—Ç–µ–Ω", 
        pigment: "–ö—Ä–∞—Å–Ω—ã–π",
        unwantedTones: ["–ö—Ä–∞—Å–Ω—ã–π", "–û—Ä–∞–Ω–∂–µ–≤—ã–π"],
        neutralization: "–ó–µ–ª–µ–Ω—ã–π (0/33)"
    },
    6: { 
        name: "–¢–µ–º–Ω–æ-—Ä—É—Å—ã–π", 
        pigment: "–û—Ä–∞–Ω–∂–µ–≤–æ-–∫—Ä–∞—Å–Ω—ã–π",
        unwantedTones: ["–û—Ä–∞–Ω–∂–µ–≤—ã–π", "–ñ–µ–ª—Ç—ã–π"],
        neutralization: "–°–∏–Ω–µ-–∑–µ–ª–µ–Ω—ã–π (0/22 + 0/33)"
    },
    7: { 
        name: "–†—É—Å—ã–π", 
        pigment: "–û—Ä–∞–Ω–∂–µ–≤—ã–π",
        unwantedTones: ["–û—Ä–∞–Ω–∂–µ–≤—ã–π", "–ñ–µ–ª—Ç—ã–π"],
        neutralization: "–°–∏–Ω–∏–π (0/22)"
    },
    8: { 
        name: "–°–≤–µ—Ç–ª–æ-—Ä—É—Å—ã–π", 
        pigment: "–ñ–µ–ª—Ç–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–π",
        unwantedTones: ["–ñ–µ–ª—Ç—ã–π", "–û—Ä–∞–Ω–∂–µ–≤—ã–π"],
        neutralization: "–§–∏–æ–ª–µ—Ç–æ–≤–æ-—Å–∏–Ω–∏–π (0/66 + 0/22)"
    },
    9: { 
        name: "–ë–ª–æ–Ω–¥–∏–Ω", 
        pigment: "–ñ–µ–ª—Ç—ã–π",
        unwantedTones: ["–ñ–µ–ª—Ç—ã–π", "–ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π"],
        neutralization: "–§–∏–æ–ª–µ—Ç–æ–≤—ã–π (0/66)"
    },
    10: { 
        name: "–°–≤–µ—Ç–ª—ã–π –±–ª–æ–Ω–¥–∏–Ω", 
        pigment: "–°–≤–µ—Ç–ª–æ-–∂–µ–ª—Ç—ã–π",
        unwantedTones: ["–ñ–µ–ª—Ç—ã–π"],
        neutralization: "–§–∏–æ–ª–µ—Ç–æ–≤—ã–π (0/66)"
    }
};

// –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï –û–ö–ò–°–õ–ò–¢–ï–õ–ï–ô (–î–û–ë–ê–í–õ–ï–ù 4.5% –∏ 7.5%)
const OXIDIZER_VOL = {
    "1.5%": "5V", "3%": "10V", "4.5%": "15V", 
    "6%": "20V", "7.5%": "25V", "9%": "30V", "12%": "40V"
};

// –í–û–ó–ú–û–ñ–ù–û–°–¢–ò –ü–†–û–î–£–ö–¢–û–í –ü–û –û–ö–ò–°–õ–ò–¢–ï–õ–Ø–ú (–û–ë–ù–û–í–õ–ï–ù–û –° 4.5% –∏ 7.5%)
const PRODUCT_CAPABILITIES = {
    permanent: {
        maxTones: 4,
        oxidizers: {
            "1.5%": { maxTones: 0, time: "20 –º–∏–Ω", purpose: "–¢–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ" },
            "3%": { maxTones: 0, time: "30 –º–∏–Ω", purpose: "–ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ/–¢–æ–Ω –≤ —Ç–æ–Ω" },
            "4.5%": { maxTones: 0, time: "30 –º–∏–Ω", purpose: "–¢–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ/–°–ª–∞–±–æ–µ –æ—Å–≤–µ—Ç–ª–µ–Ω–∏–µ" },
            "6%": { maxTones: 1, time: "40 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 1 —Ç–æ–Ω" },
            "7.5%": { maxTones: 2, time: "35 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 2 —Ç–æ–Ω–∞" },
            "9%": { maxTones: 3, time: "40 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 2-3 —Ç–æ–Ω–∞" },
            "12%": { maxTones: 4, time: "40 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 4 —Ç–æ–Ω–∞" }
        }
    },
    powder: {
        maxTones: 10,
        oxidizers: {
            "3%": { maxTones: 2, time: "15-20 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 1-2 —Ç–æ–Ω–∞" },
            "4.5%": { maxTones: 3, time: "20-25 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 2-3 —Ç–æ–Ω–∞" },
            "6%": { maxTones: 4, time: "25-35 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 3-4 —Ç–æ–Ω–∞" },
            "7.5%": { maxTones: 5, time: "30-40 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 4-5 —Ç–æ–Ω–æ–≤" },
            "9%": { maxTones: 8, time: "35-50 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 5-8 —Ç–æ–Ω–æ–≤" },
            "12%": { maxTones: 10, time: "35-50 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 9-10 —Ç–æ–Ω–æ–≤" }
        }
    },
    special_blond: {
        maxTones: 4,
        oxidizers: {
            "6%": { maxTones: 1, time: "35 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 1 —Ç–æ–Ω" },
            "7.5%": { maxTones: 2, time: "40 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 2 —Ç–æ–Ω–∞" },
            "9%": { maxTones: 2, time: "40 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 1-2 —Ç–æ–Ω–∞" },
            "12%": { maxTones: 4, time: "50 –º–∏–Ω", purpose: "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ 3-4 —Ç–æ–Ω–∞" }
        }
    },
    toner: {
        maxTones: 0,
        oxidizers: {
            "1.5%": { maxTones: 0, time: "20 –º–∏–Ω", purpose: "–ü–∞—Å—Ç–µ–ª—å–Ω–æ–µ —Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ" },
            "3%": { maxTones: 0, time: "20-30 –º–∏–Ω", purpose: "–¢–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ" },
            "4.5%": { maxTones: 0, time: "25-35 –º–∏–Ω", purpose: "–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–µ —Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ" }
        }
    }
};

// –ö–û–≠–§–§–ò–¶–ò–ï–ù–¢–´ –î–õ–Ø –†–ê–ó–ù–´–• –¢–ò–ü–û–í –í–û–õ–û–°
const HAIR_TYPE_COEFFICIENTS = {
    virgin: { maxTonesPerStage: 4, safetyMultiplier: 1.0, description: "–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ –∑–¥–æ—Ä–æ–≤—ã–µ –≤–æ–ª–æ—Å—ã" },
    colored: { maxTonesPerStage: 2, safetyMultiplier: 0.6, description: "–†–∞–Ω–µ–µ –æ–∫—Ä–∞—à–µ–Ω–Ω—ã–µ –≤–æ–ª–æ—Å—ã" },
    lightened: { maxTonesPerStage: 2, safetyMultiplier: 0.5, description: "–û—Å–≤–µ—Ç–ª–µ–Ω–Ω—ã–µ –≤–æ–ª–æ—Å—ã" },
    damaged: { maxTonesPerStage: 1, safetyMultiplier: 0.4, description: "–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ –≤–æ–ª–æ—Å—ã" }
};

// –¢–ê–ë–õ–ò–¶–ê –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô (–û–ë–ù–û–í–õ–ï–ù–û)
const RECOMMENDATION_TABLE = {
    toning: { product: "toner", oxidizer: "1.5-3%", time: "20 –º–∏–Ω—É—Ç", ratio: "1:1" },
    darkening: { product: "permanent", oxidizer: "3%", time: "30 –º–∏–Ω—É—Ç", ratio: "1:1" },
    ton_in_ton: {
        virgin: { product: "permanent", oxidizer: "3%", time: "30 –º–∏–Ω—É—Ç", ratio: "1:1" },
        colored: { product: "permanent", oxidizer: "6%", time: "30 –º–∏–Ω—É—Ç", ratio: "1:1" }
    },
    gray_coverage: { product: "permanent", oxidizer: "6%", time: "40 –º–∏–Ω—É—Ç", ratio: "1:1" }
};

// –†–ê–°–ß–ï–¢ –ö–û–†–†–ï–ö–¢–û–†–ê –î–õ–Ø –û–°–í–ï–¢–õ–ï–ù–ò–Ø (–ü–û –¢–ï–ö–£–©–ï–ú–£ –ò –ñ–ï–õ–ê–ï–ú–û–ú–£ –£–†–û–í–ù–Ø–ú)
function calculateCorrectorForLightening(currentLevel, targetLevel, rule = 'rule10') {
    const isDarkening = targetLevel < currentLevel;
    const isTonInTon = targetLevel === currentLevel;
    
    // –ï—Å–ª–∏ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ –∏–ª–∏ —Ç–æ–Ω –≤ —Ç–æ–Ω - –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä –Ω–µ –Ω—É–∂–µ–Ω –∏–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π
    if (isDarkening || isTonInTon) {
        return {
            needed: false,
            cm: 0,
            g: 0,
            formula: "–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è",
            explanation: "–ü—Ä–∏ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–∏ –∏–ª–∏ —Ç–æ–Ω–µ –≤ —Ç–æ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è"
        };
    }
    
    const ruleNumber = rule === 'rule10' ? 10 : 11;
    
    // –†–∞—Å—á–µ—Ç –¥–ª—è –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è: –∏—Å–ø–æ–ª—å–∑—É–µ–º –∂–µ–ª–∞–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞
    const targetData = CORRECTOR_CALCULATION_TABLE[ruleNumber][targetLevel] || { cm: 0, g: 0 };
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–Ω–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –∏ –∂–µ–ª–∞–µ–º–æ–≥–æ —É—Ä–æ–≤–Ω–µ–π
    const currentData = LIGHTENING_BACKGROUNDS[currentLevel];
    const targetDataInfo = LIGHTENING_BACKGROUNDS[targetLevel];
    
    let correctionNeeded = "";
    let unwantedTones = [];
    
    if (currentData && targetDataInfo) {
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–∏–µ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–Ω–∞ –º–æ–≥—É—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –ø—Ä–∏ –æ—Å–≤–µ—Ç–ª–µ–Ω–∏–∏
        unwantedTones = targetDataInfo.unwantedTones || [];
        
        if (unwantedTones.length > 0) {
            correctionNeeded = `–ù–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è: ${targetDataInfo.neutralization}`;
        }
    }
    
    return {
        needed: true,
        cm: targetData.cm,
        g: targetData.g,
        rule: ruleNumber,
        formula: `${ruleNumber} - ${targetLevel} = ${targetData.cm} —Å–º`,
        explanation: rule === 'rule10' ? 
            "–ü—Ä–∞–≤–∏–ª–æ 10: 10 - –∂–µ–ª–∞–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å —Ç–æ–Ω–∞ = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞ –≤ —Å–º" :
            "–ü—Ä–∞–≤–∏–ª–æ 11: 11 - –∂–µ–ª–∞–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å —Ç–æ–Ω–∞ = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞ –≤ —Å–º",
        currentUnwantedTones: currentData?.unwantedTones || [],
        targetUnwantedTones: targetDataInfo?.unwantedTones || [],
        neutralization: targetDataInfo?.neutralization || "",
        correctionNeeded: correctionNeeded
    };
}

// –û–°–¢–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –û–°–¢–ê–Æ–¢–°–Ø –ü–†–ï–ñ–ù–ò–ú–ò, –î–û–ë–ê–í–õ–Ø–ï–ú –¢–û–õ–¨–ö–û –ù–ï–û–ë–•–û–î–ò–ú–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

function selectHairType(type, button) {
    selectedHairType = type;
    updateButtonStyles(button, 'hair-type');
    updateProductRecommendation();
}

function selectProductType(type, button) {
    selectedProductType = type;
    updateButtonStyles(button, 'product-type');
    updateOxidizerOptions();
}

function selectProcedureType(type, button) {
    selectedProcedureType = type;
    updateButtonStyles(button, 'procedure-type');
    updateProductRecommendation();
}

function selectOxidizer(type, value, button) {
    selectedOxidizerType = type;
    selectedOxidizerValue = value;
    updateButtonStyles(button, 'oxidizer');
}

function selectCorrectorRule(rule, button) {
    selectedCorrectorRule = rule;
    updateButtonStyles(button, 'corrector-rule');
}

function updateButtonStyles(button, type) {
    if (!button) return;
    
    const container = button.parentElement;
    if (!container) return;
    
    const buttons = container.querySelectorAll('button');
    buttons.forEach(btn => {
        btn.style.background = 'white';
        btn.style.color = '#333';
        btn.style.border = '2px solid #ccc';
    });
    
    switch(type) {
        case 'hair-type':
            const hairColor = getComputedStyle(button).borderColor;
            button.style.background = hairColor;
            button.style.color = 'white';
            button.style.border = `2px solid ${hairColor}`;
            break;
        case 'product-type':
            const productColor = PRODUCT_TYPES[selectedProductType]?.color || '#4a148c';
            button.style.background = productColor;
            button.style.color = 'white';
            button.style.border = `2px solid ${productColor}`;
            break;
        case 'procedure-type':
            const procedureColor = PROCEDURE_TYPES[selectedProcedureType]?.color || '#4a148c';
            button.style.background = procedureColor;
            button.style.color = 'white';
            button.style.border = `2px solid ${procedureColor}`;
            break;
        case 'oxidizer':
            button.style.background = '#4a148c';
            button.style.color = 'white';
            button.style.border = '2px solid #4a148c';
            break;
        case 'corrector-rule':
            button.style.background = '#9c27b0';
            button.style.color = 'white';
            button.style.border = '2px solid #9c27b0';
            break;
    }
}

function updateProductRecommendation() {
    const modal = document.querySelector('.modal:last-child');
    if (!modal) return;
    
    if (selectedProcedureType === 'auto') return;
    
    updateOxidizerOptions();
}

function updateOxidizerOptions() {
    const modal = document.querySelector('.modal:last-child');
    if (!modal) return;
    
    const oxidizerContainer = modal.querySelector('#oxidizerOptions');
    if (!oxidizerContainer) return;
    
    const productCapabilities = PRODUCT_CAPABILITIES[selectedProductType] || PRODUCT_CAPABILITIES.permanent;
    const availableOxidizers = Object.keys(productCapabilities.oxidizers);
    
    oxidizerContainer.innerHTML = '';
    
    // –ê–≤—Ç–æ-–≤—ã–±–æ—Ä
    const autoButton = document.createElement('button');
    autoButton.textContent = 'ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä';
    autoButton.style.cssText = `padding: 8px 12px; margin: 2px; border: 2px solid #ccc; 
                               background: ${selectedOxidizerType === 'auto' ? '#4a148c' : 'white'}; 
                               color: ${selectedOxidizerType === 'auto' ? 'white' : '#333'}; 
                               border-radius: 5px; cursor: pointer;`;
    autoButton.onclick = () => selectOxidizer('auto', null, autoButton);
    oxidizerContainer.appendChild(autoButton);
    
    // –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–∫–∏—Å–ª–∏—Ç–µ–ª–∏
    availableOxidizers.forEach(ox => {
        const button = document.createElement('button');
        button.textContent = `${ox} (${OXIDIZER_VOL[ox]})`;
        button.style.cssText = `padding: 6px 10px; margin: 2px; border: 2px solid #ccc; 
                               background: ${selectedOxidizerValue === ox ? '#4a148c' : 'white'}; 
                               color: ${selectedOxidizerValue === ox ? 'white' : '#333'}; 
                               border-radius: 4px; cursor: pointer; font-size: 0.9em;`;
        button.onclick = () => selectOxidizer('custom', ox, button);
        oxidizerContainer.appendChild(button);
    });
}

// –†–ê–°–ß–ï–¢ –ö–†–ê–°–Ø–©–ï–ô –°–ú–ï–°–ò (–û–ë–ù–û–í–õ–ï–ù–û)
function calculateColorMix(currentLevel, targetLevel, productType, totalColor = 60, rule = 'rule10') {
    const correctorData = calculateCorrectorForLightening(currentLevel, targetLevel, rule);
    const correctorGrams = correctorData.g * 2; // –î–ª—è 60–≥ —Å–º–µ—Å–∏
    const colorGrams = totalColor - correctorGrams;
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏—é –æ–∫–∏—Å–ª–∏—Ç–µ–ª—è
    let ratio = "1:1";
    let oxidizerMl = totalColor;
    
    if (selectedOxidizerType === 'custom' && selectedOxidizerValue) {
        ratio = PRODUCT_TYPES[productType]?.ratios[selectedOxidizerValue] || "1:1";
    } else {
        // –î–ª—è –∞–≤—Ç–æ-–≤—ã–±–æ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –ø—Ä–æ–ø–æ—Ä—Ü–∏—é
        if (productType === 'powder' || productType === 'special_blond') {
            ratio = "1:2";
        }
    }
    
    oxidizerMl = ratio === "1:2" ? totalColor * 2 : totalColor;
    
    return {
        color: colorGrams,
        corrector: correctorGrams,
        oxidizer: oxidizerMl,
        total: totalColor,
        ratio: ratio,
        formula: correctorData.needed ? 
            `${colorGrams.toFixed(1)}–≥ ${PRODUCT_TYPES[productType]?.name || '–ø—Ä–æ–¥—É–∫—Ç–∞'} + ${correctorGrams.toFixed(1)}–≥ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞ + ${oxidizerMl}–º–ª –æ–∫–∏—Å–ª–∏—Ç–µ–ª—è` :
            `${colorGrams.toFixed(1)}–≥ ${PRODUCT_TYPES[productType]?.name || '–ø—Ä–æ–¥—É–∫—Ç–∞'} + ${oxidizerMl}–º–ª –æ–∫–∏—Å–ª–∏—Ç–µ–ª—è`,
        correctorData: correctorData
    };
}

// –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –¢–ò–ü–ê –ü–†–û–¶–ï–î–£–†–´
function determineProcedureType(currentLevel, targetLevel, hairType, hasGrayHair) {
    if (selectedProcedureType !== 'auto') return selectedProcedureType;
    
    const tones = Math.abs(targetLevel - currentLevel);
    const isDarkening = targetLevel < currentLevel;
    const isTonInTon = targetLevel === currentLevel;
    
    if (hasGrayHair) return 'gray_coverage';
    if (isDarkening) return 'darkening';
    if (isTonInTon) return 'ton_in_ton';
    if (tones === 0) return 'toning';
    if (tones <= 4) return 'lightening';
    return 'bleaching';
}

// –ê–í–¢–û-–ü–û–î–ë–û–† –ü–†–û–î–£–ö–¢–ê –ò –û–ö–ò–°–õ–ò–¢–ï–õ–Ø (–û–ë–ù–û–í–õ–ï–ù–û –° 4.5% –∏ 7.5%)
function getAutoRecommendation(procedureType, tones, hairType, hasGrayHair, currentLevel, targetLevel) {
    const hairCoeff = HAIR_TYPE_COEFFICIENTS[hairType];
    
    if (hasGrayHair) {
        return { 
            ...RECOMMENDATION_TABLE.gray_coverage, 
            isAuto: true,
            reason: "–î–ª—è –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è —Å–µ–¥—ã—Ö –≤–æ–ª–æ—Å"
        };
    }
    
    switch(procedureType) {
        case 'toning':
            return { 
                ...RECOMMENDATION_TABLE.toning, 
                isAuto: true,
                reason: "–ü–∞—Å—Ç–µ–ª—å–Ω–æ–µ —Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"
            };
            
        case 'darkening':
            return { 
                ...RECOMMENDATION_TABLE.darkening, 
                isAuto: true,
                reason: "–ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞"
            };
            
        case 'ton_in_ton':
            const tonRec = RECOMMENDATION_TABLE.ton_in_ton;
            const specificRec = hairType === 'virgin' ? tonRec.virgin : tonRec.colored;
            return { 
                ...specificRec, 
                isAuto: true,
                reason: "–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ —Ç–æ–Ω –≤ —Ç–æ–Ω"
            };
            
        case 'lightening':
        case 'bleaching':
            // –ü–û–î–ë–û–† –ü–†–û–î–£–ö–¢–ê –î–õ–Ø –ú–ò–ù–ò–ú–ê–õ–¨–ù–û–ì–û –ö–û–õ–ò–ß–ï–°–¢–í–ê –≠–¢–ê–ü–û–í
            let product = 'permanent';
            let oxidizer = "6%";
            let time = "40 –º–∏–Ω—É—Ç";
            let ratio = "1:1";
            let reason = "";
            
            if (tones === 1) {
                product = 'permanent';
                oxidizer = "6%";
                time = "40 –º–∏–Ω—É—Ç";
                ratio = "1:1";
                reason = "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ –Ω–∞ 1 —Ç–æ–Ω";
            } else if (tones === 2) {
                product = 'permanent';
                oxidizer = "7.5%";
                time = "35 –º–∏–Ω—É—Ç";
                ratio = "1:1";
                reason = "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ –Ω–∞ 2 —Ç–æ–Ω–∞";
            } else if (tones === 3) {
                product = 'permanent';
                oxidizer = "9%";
                time = "40 –º–∏–Ω—É—Ç";
                ratio = "1:1";
                reason = "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ –Ω–∞ 3 —Ç–æ–Ω–∞";
            } else if (tones === 4) {
                product = 'permanent';
                oxidizer = "12%";
                time = "40 –º–∏–Ω—É—Ç";
                ratio = "1:1";
                reason = "–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ –Ω–∞ 4 —Ç–æ–Ω–∞";
            } else if (tones === 5) {
                product = 'powder';
                oxidizer = "7.5%";
                time = "30-40 –º–∏–Ω—É—Ç";
                ratio = "1:2";
                reason = "–û–±–µ—Å—Ü–≤–µ—á–∏–≤–∞–Ω–∏–µ –Ω–∞ 5 —Ç–æ–Ω–æ–≤";
            } else if (tones <= 6) {
                product = 'powder';
                oxidizer = "9%";
                time = "35-50 –º–∏–Ω—É—Ç";
                ratio = "1:2";
                reason = `–û–±–µ—Å—Ü–≤–µ—á–∏–≤–∞–Ω–∏–µ –Ω–∞ ${tones} —Ç–æ–Ω–æ–≤`;
            } else if (tones <= 8) {
                product = 'powder';
                oxidizer = "9%";
                time = "35-50 –º–∏–Ω—É—Ç";
                ratio = "1:2";
                reason = `–û–±–µ—Å—Ü–≤–µ—á–∏–≤–∞–Ω–∏–µ –Ω–∞ ${tones} —Ç–æ–Ω–æ–≤`;
            } else {
                product = 'powder';
                oxidizer = "12%";
                time = "35-50 –º–∏–Ω—É—Ç";
                ratio = "1:2";
                reason = `–û–±–µ—Å—Ü–≤–µ—á–∏–≤–∞–Ω–∏–µ –Ω–∞ ${tones} —Ç–æ–Ω–æ–≤`;
            }
            
            // –î–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –≤–æ–ª–æ—Å –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —ç—Ç–∞–ø–Ω–æ—Å—Ç—å
            if (hairCoeff.safetyMultiplier < 1 && tones > hairCoeff.maxTonesPerStage) {
                reason += `. –î–ª—è ${hairCoeff.description} —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ—ç—Ç–∞–ø–Ω—ã–π –ø–æ–¥—Ö–æ–¥`;
            }
            
            return {
                product: product,
                oxidizer: oxidizer,
                time: time,
                ratio: ratio,
                isAuto: true,
                reason: reason
            };
            
        default:
            return {
                product: 'permanent',
                oxidizer: "6%",
                time: "40 –º–∏–Ω—É—Ç",
                ratio: "1:1",
                isAuto: true,
                reason: "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ"
            };
    }
}

// –ü–†–û–í–ï–†–ö–ê –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–ò (–û–ë–ù–û–í–õ–ï–ù–û)
function checkCompatibility(productType, oxidizer, tones, hairType) {
    const capabilities = PRODUCT_CAPABILITIES[productType];
    const hairCoeff = HAIR_TYPE_COEFFICIENTS[hairType];
    
    if (!capabilities) return { compatible: false, reason: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –ø—Ä–æ–¥—É–∫—Ç–∞" };
    
    const oxidizerCap = capabilities.oxidizers[oxidizer];
    if (!oxidizerCap) return { compatible: false, reason: "–î–∞–Ω–Ω—ã–π –æ–∫–∏—Å–ª–∏—Ç–µ–ª—å –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞" };
    
    // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —Ç–æ–Ω–∞ –¥–ª—è —Ç–∏–ø–∞ –≤–æ–ª–æ—Å
    const adjustedMaxTones = Math.floor(oxidizerCap.maxTones * hairCoeff.safetyMultiplier);
    
    if (tones > adjustedMaxTones) {
        return { 
            compatible: false, 
            reason: `–î–ª—è ${hairCoeff.description} —Å –æ–∫–∏—Å–ª–∏—Ç–µ–ª–µ–º ${oxidizer} –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –æ—Å–≤–µ—Ç–ª–µ–Ω–∏–µ - ${adjustedMaxTones} —Ç–æ–Ω–æ–≤. –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ—ç—Ç–∞–ø–Ω—ã–π –ø–æ–¥—Ö–æ–¥.`
        };
    }
    
    return { 
        compatible: true, 
        purpose: oxidizerCap.purpose,
        maxTones: adjustedMaxTones
    };
}

// –ü–û–≠–¢–ê–ü–ù–´–ô –ü–õ–ê–ù (–û–ë–ù–û–í–õ–ï–ù–û –° 4.5% –∏ 7.5%)
function calculateMultiStagePlan(currentLevel, targetLevel, productType, hairType, tones, selectedOxidizer) {
    const plans = [];
    const hairCoeff = HAIR_TYPE_COEFFICIENTS[hairType];
    const maxTonesPerStage = hairCoeff.maxTonesPerStage;
    
    // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–∫–∏—Å–ª–∏—Ç–µ–ª—å
    if (selectedOxidizerType === 'custom' && selectedOxidizerValue) {
        const compatibility = checkCompatibility(productType, selectedOxidizerValue, tones, hairType);
        
        if (!compatibility.compatible) {
            // –†–ê–°–ß–ï–¢ –ü–û–≠–¢–ê–ü–ù–û–ì–û –ü–õ–ê–ù–ê –° –í–´–ë–†–ê–ù–ù–´–ú –ü–†–û–î–£–ö–¢–û–ú
            let remainingTones = tones;
            let currentStageLevel = currentLevel;
            let stage = 1;
            const maxStages = 3;
            
            while (remainingTones > 0 && stage <= maxStages) {
                const stageTones = Math.min(remainingTones, maxTonesPerStage);
                
                // –ü–æ–¥–±–∏—Ä–∞–µ–º –æ–∫–∏—Å–ª–∏—Ç–µ–ª—å –¥–ª—è —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –° –í–´–ë–†–ê–ù–ù–´–ú –ü–†–û–î–£–ö–¢–û–ú
                let stageOxidizer;
                
                if (productType === 'powder') {
                    if (stageTones <= 2) stageOxidizer = "3%";
                    else if (stageTones <= 3) stageOxidizer = "4.5%";
                    else if (stageTones <= 4) stageOxidizer = "6%";
                    else if (stageTones <= 5) stageOxidizer = "7.5%";
                    else if (stageTones <= 8) stageOxidizer = "9%";
                    else stageOxidizer = "12%";
                } else if (productType === 'special_blond') {
                    if (stageTones <= 1) stageOxidizer = "6%";
                    else if (stageTones <= 2) stageOxidizer = "7.5%";
                    else if (stageTones <= 3) stageOxidizer = "9%";
                    else stageOxidizer = "12%";
                } else if (productType === 'permanent') {
                    if (stageTones <= 1) stageOxidizer = "6%";
                    else if (stageTones <= 2) stageOxidizer = "7.5%";
                    else if (stageTones <= 3) stageOxidizer = "9%";
                    else if (stageTones <= 4) stageOxidizer = "12%";
                    else stageOxidizer = "9%"; // fallback
                } else {
                    stageOxidizer = "3%";
                }
                
                const stageInfo = PRODUCT_CAPABILITIES[productType]?.oxidizers[stageOxidizer] || 
                                  PRODUCT_CAPABILITIES.permanent.oxidizers["6%"];
                const stageRatio = PRODUCT_TYPES[productType]?.ratios[stageOxidizer] || "1:1";
                
                plans.push({
                    stage: stage,
                    from: currentStageLevel,
                    to: currentStageLevel + stageTones,
                    tones: stageTones,
                    product: productType,
                    oxidizer: stageOxidizer,
                    time: stageInfo.time,
                    ratio: stageRatio,
                    interval: stage === 1 ? "–°–µ–π—á–∞—Å" : "–ß–µ—Ä–µ–∑ 4-6 –Ω–µ–¥–µ–ª—å",
                    reason: `${hairCoeff.description}: –º–∞–∫—Å–∏–º—É–º ${maxTonesPerStage} —Ç–æ–Ω–∞ –∑–∞ —ç—Ç–∞–ø`
                });
                
                currentStageLevel += stageTones;
                remainingTones -= stageTones;
                stage++;
            }
            
            return {
                needsMultiStage: true,
                reason: compatibility.reason,
                plans: plans
            };
        }
        
        return { needsMultiStage: false, plans: [] };
    }
    
    // –î–õ–Ø –ê–í–¢–û-–í–´–ë–û–†–ê: –ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–µ–Ω –ª–∏ –ø–æ—ç—Ç–∞–ø–Ω—ã–π –ø–æ–¥—Ö–æ–¥
    const autoRecommendation = getAutoRecommendation('lightening', tones, hairType, false, currentLevel, targetLevel);
    const compatibility = checkCompatibility(productType, autoRecommendation.oxidizer, tones, hairType);
    
    if (tones > maxTonesPerStage) {
        let remainingTones = tones;
        let currentStageLevel = currentLevel;
        let stage = 1;
        const maxStages = 3;
        
        while (remainingTones > 0 && stage <= maxStages) {
            const stageTones = Math.min(remainingTones, maxTonesPerStage);
            
            let stageProduct = productType === 'auto' ? autoRecommendation.product : productType;
            let stageOxidizer;
            
            if (stageProduct === 'powder') {
                if (stageTones <= 2) stageOxidizer = "3%";
                else if (stageTones <= 3) stageOxidizer = "4.5%";
                else if (stageTones <= 4) stageOxidizer = "6%";
                else if (stageTones <= 5) stageOxidizer = "7.5%";
                else stageOxidizer = "9%";
            } else if (stageProduct === 'special_blond') {
                if (stageTones <= 1) stageOxidizer = "6%";
                else if (stageTones <= 2) stageOxidizer = "7.5%";
                else stageOxidizer = "9%";
            } else if (stageProduct === 'permanent') {
                if (stageTones <= 1) stageOxidizer = "6%";
                else if (stageTones <= 2) stageOxidizer = "7.5%";
                else if (stageTones <= 3) stageOxidizer = "9%";
                else stageOxidizer = "12%";
            } else {
                stageOxidizer = "3%";
            }
            
            const stageInfo = PRODUCT_CAPABILITIES[stageProduct]?.oxidizers[stageOxidizer] || 
                              PRODUCT_CAPABILITIES.permanent.oxidizers["6%"];
            const stageRatio = PRODUCT_TYPES[stageProduct]?.ratios[stageOxidizer] || "1:1";
            
            plans.push({
                stage: stage,
                from: currentStageLevel,
                to: currentStageLevel + stageTones,
                tones: stageTones,
                product: stageProduct,
                oxidizer: stageOxidizer,
                time: stageInfo.time,
                ratio: stageRatio,
                interval: stage === 1 ? "–°–µ–π—á–∞—Å" : "–ß–µ—Ä–µ–∑ 4-6 –Ω–µ–¥–µ–ª—å",
                reason: `${hairCoeff.description}: –º–∞–∫—Å–∏–º—É–º ${maxTonesPerStage} —Ç–æ–Ω–∞ –∑–∞ —ç—Ç–∞–ø`
            });
            
            currentStageLevel += stageTones;
            remainingTones -= stageTones;
            stage++;
        }
        
        return {
            needsMultiStage: true,
            reason: `${hairCoeff.description}. –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è –Ω–∞ ${tones} —Ç–æ–Ω–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ—ç—Ç–∞–ø–Ω—ã–π –ø–æ–¥—Ö–æ–¥`,
            plans: plans
        };
    }
    
    return { needsMultiStage: false, plans: [] };
}

// –ü–û–õ–£–ß–ï–ù–ò–ï –û–ü–¢–ò–ú–ê–õ–¨–ù–û–ì–û –û–ö–ò–°–õ–ò–¢–ï–õ–Ø –î–õ–Ø –ü–†–û–î–£–ö–¢–ê (–û–ë–ù–û–í–õ–ï–ù–û)
function getOptimalOxidizerForProduct(productType, tones, hairType) {
    const capabilities = PRODUCT_CAPABILITIES[productType];
    const hairCoeff = HAIR_TYPE_COEFFICIENTS[hairType];
    
    if (!capabilities) return "6%";
    
    // –ò—â–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–∫–∏—Å–ª–∏—Ç–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –æ—Å–≤–µ—Ç–ª–∏—Ç—å –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–Ω–æ–≤
    const oxidizerOrder = ["3%", "4.5%", "6%", "7.5%", "9%", "12%"];
    
    for (const oxidizer of oxidizerOrder) {
        const info = capabilities.oxidizers[oxidizer];
        if (info) {
            const adjustedMaxTones = Math.floor(info.maxTones * hairCoeff.safetyMultiplier);
            if (adjustedMaxTones >= tones) {
                return oxidizer;
            }
        }
    }
    
    return "12%";
}

// –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –†–ê–°–ß–ï–¢–ê
function calculateColoring() {
    const modal = document.querySelector('.modal:last-child');
    if (!modal) return;
    
    const current = modal.querySelector('#currentLevel');
    const target = modal.querySelector('#targetLevel');
    const grayCheckbox = modal.querySelector('#grayHair');
    const resultDiv = modal.querySelector('#coloringResult');
    
    if (!current || !target || !resultDiv) return;
    
    const currentValue = parseInt(current.value);
    const targetValue = parseInt(target.value);
    const hasGrayHair = grayCheckbox ? grayCheckbox.checked : false;
    
    if (!currentValue || !targetValue) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –∏ –∂–µ–ª–∞–µ–º—ã–π —É—Ä–æ–≤–Ω–∏!');
        return;
    }
    
    const tones = Math.abs(targetValue - currentValue);
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ—Ü–µ–¥—É—Ä—É
    const procedureType = determineProcedureType(currentValue, targetValue, selectedHairType, hasGrayHair);
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ–¥—É–∫—Ç
    let productType = selectedProductType;
    let recommendation;
    
    if (productType === 'auto') {
        recommendation = getAutoRecommendation(procedureType, tones, selectedHairType, hasGrayHair, currentValue, targetValue);
        productType = recommendation.product;
    } else if (selectedOxidizerType === 'custom' && selectedOxidizerValue) {
        const compatibility = checkCompatibility(productType, selectedOxidizerValue, tones, selectedHairType);
        
        if (!compatibility.compatible) {
            recommendation = {
                product: productType,
                oxidizer: selectedOxidizerValue,
                time: "–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ —ç—Ç–∞–ø–∞–º",
                ratio: PRODUCT_TYPES[productType]?.ratios[selectedOxidizerValue] || "1:1",
                isAuto: false,
                warning: compatibility.reason
            };
        } else {
            const productInfo = PRODUCT_CAPABILITIES[productType]?.oxidizers[selectedOxidizerValue];
            recommendation = {
                product: productType,
                oxidizer: selectedOxidizerValue,
                time: productInfo?.time || "40 –º–∏–Ω—É—Ç",
                ratio: PRODUCT_TYPES[productType]?.ratios[selectedOxidizerValue] || "1:1",
                isAuto: false,
                purpose: compatibility.purpose,
                reason: `–í—ã–±—Ä–∞–Ω–Ω—ã–π –≤–∞–º–∏ –ø—Ä–æ–¥—É–∫—Ç –∏ –æ–∫–∏—Å–ª–∏—Ç–µ–ª—å`
            };
        }
    } else {
        const autoOxidizer = getOptimalOxidizerForProduct(productType, tones, selectedHairType);
        const productInfo = PRODUCT_CAPABILITIES[productType]?.oxidizers[autoOxidizer];
        
        recommendation = {
            product: productType,
            oxidizer: autoOxidizer,
            time: productInfo?.time || "40 –º–∏–Ω—É—Ç",
            ratio: PRODUCT_TYPES[productType]?.ratios[autoOxidizer] || "1:1",
            isAuto: true,
            purpose: productInfo?.purpose || "",
            reason: `–ê–≤—Ç–æ–ø–æ–¥–±–æ—Ä –æ–∫–∏—Å–ª–∏—Ç–µ–ª—è –¥–ª—è ${PRODUCT_TYPES[productType]?.name}`
        };
    }
    
    // –†–∞—Å—á–µ—Ç –ø–æ—ç—Ç–∞–ø–Ω–æ–≥–æ –ø–ª–∞–Ω–∞
    const multiStagePlan = calculateMultiStagePlan(
        currentValue, targetValue, productType, selectedHairType, 
        tones, selectedOxidizerValue
    );
    
    // –†–∞—Å—á–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞ –∏ —Å–º–µ—Å–∏
    const colorMix = calculateColorMix(currentValue, targetValue, productType, 60, selectedCorrectorRule);
    const currentData = LIGHTENING_BACKGROUNDS[currentValue];
    const targetData = LIGHTENING_BACKGROUNDS[targetValue];
    
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    resultDiv.innerHTML = generateResultHTML(
        currentValue, targetValue, procedureType, tones,
        recommendation, productType, multiStagePlan,
        colorMix, currentData, targetData, hasGrayHair
    );
    
    resultDiv.style.display = 'block';
    resultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// –ì–ï–ù–ï–†–ê–¶–ò–Ø HTML –†–ï–ó–£–õ–¨–¢–ê–¢–ê (–û–ë–ù–û–í–õ–ï–ù–û –° –ò–ù–§–û–†–ú–ê–¶–ò–ï–ô –û –¢–û–ù–ê–•)
function generateResultHTML(currentLevel, targetLevel, procedureType, tones,
                          recommendation, productType, multiStagePlan,
                          colorMix, currentData, targetData, hasGrayHair) {
    
    const procedureInfo = PROCEDURE_TYPES[procedureType];
    const productInfo = PRODUCT_TYPES[productType];
    const hairCoeff = HAIR_TYPE_COEFFICIENTS[selectedHairType];
    const correctorData = colorMix.correctorData;
    
    return `
        <!-- –ó–ê–ì–û–õ–û–í–û–ö -->
        <div style="text-align: center; margin-bottom: 20px; padding: 15px; 
                    background: linear-gradient(135deg, ${procedureInfo.color}22 0%, ${procedureInfo.color}44 100%); 
                    border-radius: 10px; border-left: 5px solid ${procedureInfo.color};">
            <div style="font-size: 2em;">${procedureInfo.icon} ${productInfo.icon}</div>
            <strong style="color: ${procedureInfo.color}; font-size: 1.3em;">
                ${procedureInfo.name} ‚Ä¢ ${productInfo.name}
            </strong>
            <div style="background: white; padding: 8px; border-radius: 5px; margin-top: 10px;">
                <strong>–£—Ä–æ–≤–µ–Ω—å ${currentLevel} (${currentData.name}) ‚Üí ${targetLevel} (${targetData.name})</strong>
                ${tones > 0 ? `<div style="color: #666; font-size: 0.9em; margin-top: 3px;">–û—Å–≤–µ—Ç–ª–µ–Ω–∏–µ –Ω–∞ ${tones} —Ç–æ–Ω–∞</div>` : ''}
                <div style="color: #666; font-size: 0.9em; margin-top: 3px;">${hairCoeff.description}</div>
            </div>
        </div>
        
        <!-- –§–û–ù–´ –û–°–í–ï–¢–õ–ï–ù–ò–Ø -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
            <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-top: 3px solid #ff5722;">
                <div style="color: #666; font-size: 0.9em;">–ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–æ–Ω</div>
                <div style="font-size: 1.2em; font-weight: 600; color: #ff5722;">${currentData.name} (—É—Ä–æ–≤–µ–Ω—å ${currentLevel})</div>
                <div style="color: #ff9800; font-size: 1.1em; margin-top: 5px;">${currentData.pigment}</div>
                <div style="font-size: 0.9em; color: #666; margin-top: 8px;">
                    <strong>–ù–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–Ω–∞:</strong><br>
                    ${currentData.unwantedTones.join(', ')}<br>
                    <strong>–ö–æ—Ä—Ä–µ–∫—Ü–∏—è:</strong> ${currentData.neutralization}
                </div>
            </div>
            
            <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-top: 3px solid #4caf50;">
                <div style="color: #666; font-size: 0.9em;">–¶–µ–ª–µ–≤–æ–π —Ñ–æ–Ω</div>
                <div style="font-size: 1.2em; font-weight: 600; color: #4caf50;">${targetData.name} (—É—Ä–æ–≤–µ–Ω—å ${targetLevel})</div>
                <div style="color: #ff9800; font-size: 1.1em; margin-top: 5px;">${targetData.pigment}</div>
                <div style="font-size: 0.9em; color: #666; margin-top: 8px;">
                    <strong>–ù–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–Ω–∞:</strong><br>
                    ${targetData.unwantedTones.join(', ')}<br>
                    <strong>–ö–æ—Ä—Ä–µ–∫—Ü–∏—è:</strong> ${targetData.neutralization}
                </div>
            </div>
        </div>
        
        <!-- –ü–ê–†–ê–ú–ï–¢–†–´ –ü–†–û–¶–ï–î–£–†–´ -->
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px;">
            <div style="background: white; padding: 12px; border-radius: 8px; text-align: center; 
                        box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-top: 3px solid ${productInfo.color};">
                <div style="color: #666; font-size: 0.85em;">–ü—Ä–æ–¥—É–∫—Ç</div>
                <div style="font-size: 1.1em; font-weight: 600; color: ${productInfo.color};">
                    ${productInfo.name}
                </div>
                <div style="font-size: 0.75em; color: #888; margin-top: 3px;">
                    ${selectedProductType === 'auto' ? 'ü§ñ –ê–≤—Ç–æ–≤—ã–±–æ—Ä' : '‚úÖ –í–∞—à –≤—ã–±–æ—Ä'}
                </div>
            </div>
            
            <div style="background: white; padding: 12px; border-radius: 8px; text-align: center; 
                        box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-top: 3px solid #4a148c;">
                <div style="color: #666; font-size: 0.85em;">–û–∫–∏—Å–ª–∏—Ç–µ–ª—å</div>
                <div style="font-size: 1.1em; font-weight: 600; color: #4a148c;">
                    ${recommendation.oxidizer}
                </div>
                <div style="font-size: 0.75em; color: #888; margin-top: 3px;">
                    ${OXIDIZER_VOL[recommendation.oxidizer] || ''}
                </div>
            </div>
            
            <div style="background: white; padding: 12px; border-radius: 8px; text-align: center; 
                        box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-top: 3px solid #2196f3;">
                <div style="color: #666; font-size: 0.85em;">–í—Ä–µ–º—è</div>
                <div style="font-size: 1.1em; font-weight: 600; color: #2196f3;">
                    ${recommendation.time}
                </div>
                <div style="font-size: 0.75em; color: #888; margin-top: 3px;">
                    –ü—Ä–æ–ø–æ—Ä—Ü–∏—è: ${recommendation.ratio}
                </div>
            </div>
            
            <div style="background: white; padding: 12px; border-radius: 8px; text-align: center; 
                        box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-top: 3px solid #9c27b0;">
                <div style="color: #666; font-size: 0.85em;">–¢–∏–ø –≤–æ–ª–æ—Å</div>
                <div style="font-size: 1.1em; font-weight: 600; color: #9c27b0;">
                    ${getHairTypeName(selectedHairType)}
                </div>
                <div style="font-size: 0.75em; color: #888; margin-top: 3px;">
                    –ú–∞–∫—Å. ${hairCoeff.maxTonesPerStage} —Ç–æ–Ω–∞/—ç—Ç–∞–ø
                </div>
            </div>
        </div>
        
        ${recommendation.warning ? `
        <div style="background: #ffebee; padding: 15px; border-radius: 8px; margin-bottom: 20px; 
                    border-left: 4px solid #d32f2f;">
            <strong style="color: #d32f2f;">‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:</strong>
            <div style="color: #c62828; margin-top: 5px;">${recommendation.warning}</div>
        </div>
        ` : ''}
        
        <!-- –†–ê–°–ß–ï–¢ –ö–û–†–†–ï–ö–¢–û–†–ê –î–õ–Ø –û–°–í–ï–¢–õ–ï–ù–ò–Ø -->
        <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
            <strong style="color: #7b1fa2;">üé® –†–ê–°–ß–ï–¢ –ö–û–†–†–ï–ö–¢–û–†–ê –î–õ–Ø –û–°–í–ï–¢–õ–ï–ù–ò–Ø:</strong>
            
            <div style="margin-top: 10px; padding: 10px; background: white; border-radius: 5px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; align-items: center;">
                    <div>
                        <div style="font-size: 1.1em; color: #7b1fa2; font-weight: 600;">
                            ${correctorData.formula}
                        </div>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">
                            ${correctorData.explanation}
                        </div>
                        ${correctorData.correctionNeeded ? `
                        <div style="font-size: 0.9em; color: #d32f2f; margin-top: 8px; padding: 8px; background: #ffebee; border-radius: 4px;">
                            <strong>–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è:</strong><br>
                            ${targetData.unwantedTones.join(', ')} ‚Üí ${targetData.neutralization}
                        </div>
                        ` : ''}
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.4em; font-weight: 800; color: #7b1fa2;">
                            ${correctorData.cm} —Å–º
                        </div>
                        <div style="font-size: 0.9em; color: #666;">
                            –∏–ª–∏ ${correctorData.g.toFixed(1)} –≥ –Ω–∞ 30–≥ –∫—Ä–∞—Å–∫–∏
                        </div>
                        <div style="font-size: 0.8em; color: #888; margin-top: 5px;">
                            ${correctorData.needed ? '–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä –Ω–µ–æ–±—Ö–æ–¥–∏–º' : '–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è'}
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 10px; padding: 10px; background: #f8f5fa; border-radius: 5px;">
                <strong>üìã –†–ï–¶–ï–ü–¢–£–†–ê –î–õ–Ø 60–≥ –°–ú–ï–°–ò:</strong>
                <div style="margin-top: 8px; font-size: 0.95em;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>
                            <div style="color: #666;">${productInfo.name}:</div>
                            <div style="font-weight: 600; color: ${productInfo.color};">${colorMix.color.toFixed(1)} –≥</div>
                        </div>
                        ${correctorData.needed ? `
                        <div>
                            <div style="color: #666;">–ö–æ—Ä—Ä–µ–∫—Ç–æ—Ä:</div>
                            <div style="font-weight: 600; color: #7b1fa2;">${colorMix.corrector.toFixed(1)} –≥</div>
                        </div>
                        ` : ''}
                        <div>
                            <div style="color: #666;">–û–∫–∏—Å–ª–∏—Ç–µ–ª—å (${colorMix.ratio}):</div>
                            <div style="font-weight: 600; color: #2196f3;">${colorMix.oxidizer} –º–ª</div>
                        </div>
                        <div>
                            <div style="color: #666;">–í—Å–µ–≥–æ —Å–º–µ—Å–∏:</div>
                            <div style="font-weight: 600; color: #4caf50;">${colorMix.total} –≥</div>
                        </div>
                    </div>
                    <div style="margin-top: 10px; padding: 8px; background: #e1bee7; border-radius: 3px; font-size: 0.9em;">
                        <strong>–§–æ—Ä–º—É–ª–∞:</strong> ${colorMix.formula}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ü–û–≠–¢–ê–ü–ù–´–ô –ü–õ–ê–ù -->
        ${multiStagePlan.needsMultiStage ? `
        <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
            <strong style="color: #388e3c;">üìÖ –ü–û–≠–¢–ê–ü–ù–´–ô –ü–õ–ê–ù –û–ö–†–ê–®–ò–í–ê–ù–ò–Ø (${multiStagePlan.plans.length} —ç—Ç–∞–ø–∞):</strong>
            <div style="color: #2e7d32; font-size: 0.9em; margin-top: 5px;">
                ${multiStagePlan.reason}
            </div>
            
            <div style="margin-top: 10px;">
                ${multiStagePlan.plans.map(stage => {
                    const stageProductInfo = PRODUCT_TYPES[stage.product];
                    return `
                    <div style="display: flex; align-items: center; margin-bottom: 10px; padding: 10px; 
                                background: white; border-radius: 5px; border-left: 4px solid ${stageProductInfo.color};">
                        <div style="background: ${stageProductInfo.color}; color: white; width: 30px; height: 30px; 
                                    border-radius: 50%; display: flex; align-items: center; 
                                    justify-content: center; margin-right: 15px; font-weight: bold;">
                            ${stage.stage}
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: #333;">
                                –≠—Ç–∞–ø ${stage.stage}: –£—Ä–æ–≤–µ–Ω—å ${stage.from} ‚Üí ${stage.to}
                            </div>
                            <div style="font-size: 0.9em; color: #666; margin-top: 3px;">
                                <strong>${stageProductInfo.name}</strong> ‚Ä¢ ${stage.tones} —Ç–æ–Ω–∞
                            </div>
                            <div style="font-size: 0.85em; color: #888; margin-top: 2px;">
                                <strong>–û–∫–∏—Å–ª–∏—Ç–µ–ª—å:</strong> ${stage.oxidizer} (${OXIDIZER_VOL[stage.oxidizer]}) | 
                                <strong>–í—Ä–µ–º—è:</strong> ${stage.time} | 
                                <strong>–ü—Ä–æ–ø–æ—Ä—Ü–∏—è:</strong> ${stage.ratio}
                            </div>
                            <div style="font-size: 0.85em; color: #888; margin-top: 2px;">
                                <strong>–ö–æ–≥–¥–∞:</strong> ${stage.interval}
                            </div>
                        </div>
                        <div style="font-size: 0.8em; color: #666; background: #f5f5f5; 
                                    padding: 3px 8px; border-radius: 12px;">
                            ${stage.reason}
                        </div>
                    </div>
                    `;
                }).join('')}
            </div>
            
            <div style="margin-top: 10px; padding: 10px; background: #c8e6c9; 
                        border-radius: 5px; font-size: 0.9em; color: #2e7d32;">
                <strong>üí° –í–∞–∂–Ω–æ:</strong> –ú–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º –ø–µ—Ä–µ—Ä—ã–≤ 4-6 –Ω–µ–¥–µ–ª—å –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤–æ–ª–æ—Å.
                –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –¥–ª—è —É—Ö–æ–¥–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.
            </div>
        </div>
        ` : ''}
        
        <!-- –¢–ê–ë–õ–ò–¶–ê –ö–û–†–†–ï–ö–¢–û–†–û–í –ü–û –ü–†–ê–í–ò–õ–£ 10 –∏ 11 -->
        <div style="background: #fff3e0; padding: 15px; border-radius: 8px; margin-top: 20px;">
            <strong style="color: #f57c00;">üìä –¢–ê–ë–õ–ò–¶–ê –ö–û–†–†–ï–ö–¢–û–†–û–í –ü–û –ü–†–ê–í–ò–õ–ê–ú 10 –∏ 11:</strong>
            
            <div style="margin-top: 10px; overflow-x: auto;">
                <div style="display: grid; grid-template-columns: repeat(12, 1fr); gap: 1px; background: #eee; border: 1px solid #eee;">
                    <div style="background: #ff9800; color: white; padding: 8px; text-align: center; font-weight: 600;">–£—Ä–æ–≤–µ–Ω—å</div>
                    <div style="background: #ff9800; color: white; padding: 8px; text-align: center; font-weight: 600;" colspan="2">–ü—Ä–∞–≤–∏–ª–æ 10</div>
                    <div style="background: #ff9800; color: white; padding: 8px; text-align: center; font-weight: 600;" colspan="2">–ü—Ä–∞–≤–∏–ª–æ 11</div>
                    <div style="background: #ff9800; color: white; padding: 8px; text-align: center; font-weight: 600;">–§–æ—Ä–º—É–ª–∞ 10</div>
                    <div style="background: #ff9800; color: white; padding: 8px; text-align: center; font-weight: 600;">–§–æ—Ä–º—É–ª–∞ 11</div>
                    <div style="background: #ff9800; color: white; padding: 8px; text-align: center; font-weight: 600;">60–≥ –∫—Ä–∞—Å–∫–∏</div>
                    <div style="background: #ff9800; color: white; padding: 8px; text-align: center; font-weight: 600;">–û–∫–∏—Å–ª–∏—Ç–µ–ª—å</div>
                    <div style="background: #ff9800; color: white; padding: 8px; text-align: center; font-weight: 600;">–í—Å–µ–≥–æ</div>
                    
                    ${[1,2,3,4,5,6,7,8,9,10].map(level => {
                        const rule10 = CORRECTOR_CALCULATION_TABLE[10][level];
                        const rule11 = CORRECTOR_CALCULATION_TABLE[11][level];
                        const mix = calculateColorMix(1, level, 'permanent', 60, 'rule10');
                        
                        return `
                        <div style="background: white; padding: 8px; text-align: center; font-weight: 600;">${level}</div>
                        <div style="background: white; padding: 8px; text-align: center;">${rule10.cm} —Å–º</div>
                        <div style="background: white; padding: 8px; text-align: center;">${rule10.g} –≥</div>
                        <div style="background: white; padding: 8px; text-align: center;">${rule11.cm} —Å–º</div>
                        <div style="background: white; padding: 8px; text-align: center;">${rule11.g} –≥</div>
                        <div style="background: white; padding: 8px; text-align: center; font-size: 0.85em;">10-${level}</div>
                        <div style="background: white; padding: 8px; text-align: center; font-size: 0.85em;">11-${level}</div>
                        <div style="background: white; padding: 8px; text-align: center; font-size: 0.85em;">${mix.color.toFixed(1)}+${mix.corrector.toFixed(1)}</div>
                        <div style="background: white; padding: 8px; text-align: center;">${mix.oxidizer} –º–ª</div>
                        <div style="background: white; padding: 8px; text-align: center;">${mix.total} –≥</div>
                        `;
                    }).join('')}
                </div>
            </div>
        </div>
    `;
}

// –§–£–ù–ö–¶–ò–Ø –ü–û–ö–ê–ó–ê –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê
function showLevelTransitionCalculator() {
    showModal("üé® –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–´–ô –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –û–ö–†–ê–®–ò–í–ê–ù–ò–Ø",
        `<div class="modal-section">
            <h3>üìä –í–´–ë–û–† –ü–ê–†–ê–ú–ï–¢–†–û–í –û–ö–†–ê–®–ò–í–ê–ù–ò–Ø:</h3>
            <div style="padding: 20px;">
                
                <!-- –£–†–û–í–ù–ò –¢–û–ù–ê -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">
                            üé® –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å:
                        </label>
                        <select id="currentLevel" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å</option>
                            ${Object.entries(LIGHTENING_BACKGROUNDS).map(([level, data]) => `
                            <option value="${level}">${level} - ${data.name}</option>
                            `).join('')}
                        </select>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">
                            üéØ –ñ–µ–ª–∞–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å:
                        </label>
                        <select id="targetLevel" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å</option>
                            ${Object.entries(LIGHTENING_BACKGROUNDS).map(([level, data]) => `
                            <option value="${level}">${level} - ${data.name}</option>
                            `).join('')}
                        </select>
                    </div>
                </div>
                
                <!-- –°–ï–î–ò–ù–ê -->
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: 600;">
                        üë¥ –ù–∞–ª–∏—á–∏–µ —Å–µ–¥–∏–Ω—ã:
                    </label>
                    <div style="display: flex; align-items: center;">
                        <input type="checkbox" id="grayHair" style="margin-right: 10px; width: 18px; height: 18px;">
                        <label for="grayHair" style="color: #666;">–í–æ–ª–æ—Å—ã —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–µ–¥–∏–Ω—É</label>
                    </div>
                </div>
                
                <!-- –¢–ò–ü –í–û–õ–û–° -->
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">
                        üîç –¢–∏–ø –≤–æ–ª–æ—Å:
                    </label>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="selectHairType('virgin', this)" 
                                style="padding: 10px 15px; border: 2px solid #4caf50; 
                                       background: ${selectedHairType === 'virgin' ? '#4caf50' : 'white'}; 
                                       color: ${selectedHairType === 'virgin' ? 'white' : '#333'}; 
                                       border-radius: 5px; cursor: pointer;">
                            üå± –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ
                        </button>
                        <button onclick="selectHairType('colored', this)" 
                                style="padding: 10px 15px; border: 2px solid #ff9800; 
                                       background: ${selectedHairType === 'colored' ? '#ff9800' : 'white'}; 
                                       color: ${selectedHairType === 'colored' ? 'white' : '#333'}; 
                                       border-radius: 5px; cursor: pointer;">
                            üé® –û–∫—Ä–∞—à–µ–Ω–Ω—ã–µ
                        </button>
                        <button onclick="selectHairType('lightened', this)" 
                                style="padding: 10px 15px; border: 2px solid #2196f3; 
                                       background: ${selectedHairType === 'lightened' ? '#2196f3' : 'white'}; 
                                       color: ${selectedHairType === 'lightened' ? 'white' : '#333'}; 
                                       border-radius: 5px; cursor: pointer;">
                            ‚ö° –û—Å–≤–µ—Ç–ª–µ–Ω–Ω—ã–µ
                        </button>
                        <button onclick="selectHairType('damaged', this)" 
                                style="padding: 10px 15px; border: 2px solid #f44336; 
                                       background: ${selectedHairType === 'damaged' ? '#f44336' : 'white'}; 
                                       color: ${selectedHairType === 'damaged' ? 'white' : '#333'}; 
                                       border-radius: 5px; cursor: pointer;">
                            ‚ö†Ô∏è –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ
                        </button>
                    </div>
                </div>
                
                <!-- –¢–ò–ü –ü–†–û–î–£–ö–¢–ê -->
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">
                        üé® –¢–∏–ø –ø—Ä–æ–¥—É–∫—Ç–∞:
                    </label>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        ${Object.entries(PRODUCT_TYPES).map(([key, product]) => `
                        <button onclick="selectProductType('${key}', this)" 
                                style="padding: 10px 15px; border: 2px solid ${product.color}; 
                                       background: ${selectedProductType === key ? product.color : 'white'}; 
                                       color: ${selectedProductType === key ? 'white' : '#333'}; 
                                       border-radius: 5px; cursor: pointer;">
                            ${product.icon} ${product.name}
                        </button>
                        `).join('')}
                    </div>
                </div>
                
                <!-- –û–ö–ò–°–õ–ò–¢–ï–õ–¨ -->
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">
                        ‚öóÔ∏è –û–∫–∏—Å–ª–∏—Ç–µ–ª—å:
                    </label>
                    <div id="oxidizerOptions" style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 15px;">
                        <!-- –û–ø—Ü–∏–∏ –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è JavaScript -->
                    </div>
                </div>
                
                <!-- –ü–†–ê–í–ò–õ–û –ö–û–†–†–ï–ö–¢–û–†–ê -->
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">
                        üìè –ü—Ä–∞–≤–∏–ª–æ —Ä–∞—Å—á–µ—Ç–∞ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞:
                    </label>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="selectCorrectorRule('rule10', this)" 
                                style="padding: 8px 12px; border: 2px solid #ccc; 
                                       background: ${selectedCorrectorRule === 'rule10' ? '#9c27b0' : 'white'}; 
                                       color: ${selectedCorrectorRule === 'rule10' ? 'white' : '#333'}; 
                                       border-radius: 5px; cursor: pointer; font-size: 0.9em;">
                            üìê –ü—Ä–∞–≤–∏–ª–æ 10 (10 - —É—Ä–æ–≤–µ–Ω—å —Ç–æ–Ω–∞)
                        </button>
                        <button onclick="selectCorrectorRule('rule11', this)" 
                                style="padding: 8px 12px; border: 2px solid #ccc; 
                                       background: ${selectedCorrectorRule === 'rule11' ? '#9c27b0' : 'white'}; 
                                       color: ${selectedCorrectorRule === 'rule11' ? 'white' : '#333'}; 
                                       border-radius: 5px; cursor: pointer; font-size: 0.9em;">
                            üìè –ü—Ä–∞–≤–∏–ª–æ 11 (11 - —É—Ä–æ–≤–µ–Ω—å —Ç–æ–Ω–∞)
                        </button>
                    </div>
                </div>
                
                <!-- –ö–ù–û–ü–ö–ê –†–ê–°–ß–ï–¢–ê -->
                <button onclick="calculateColoring()" 
                        style="width: 100%; padding: 15px; 
                               background: linear-gradient(135deg, #4a148c 0%, #6a1b9a 100%); 
                               color: white; border: none; border-radius: 8px; 
                               font-size: 1.1em; font-weight: 600; cursor: pointer;">
                    ‚ö° –†–ê–°–°–ß–ò–¢–ê–¢–¨ –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–´–ô –ü–õ–ê–ù
                </button>
                
                <div id="coloringResult" style="margin-top: 20px; display: none;">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>`
    );
    
    setTimeout(updateOxidizerOptions, 100);
}

// –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
function getHairTypeName(type) {
    const names = {
        'virgin': '–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ',
        'colored': '–û–∫—Ä–∞—à–µ–Ω–Ω—ã–µ',
        'lightened': '–û—Å–≤–µ—Ç–ª–µ–Ω–Ω—ã–µ',
        'damaged': '–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ'
    };
    return names[type] || type;
}

function showModal(title, content) {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <h2>${title}</h2>
                <span class="close" onclick="this.parentElement.parentElement.parentElement.style.display='none'">&times;</span>
            </div>
            <div class="modal-body">${content}</div>
        </div>
    `;
    document.body.appendChild(modal);
    modal.style.display = 'block';
    
    modal.onclick = function(e) {
        if (e.target === modal) modal.style.display = 'none';
    }
}

        // ============================================
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        // ============================================

        function initApp() {
            createDepthSegments();
            createToneSegments();
            selectExample(7, 1);
            updateOnlineStatus();
            
            window.addEventListener('online', updateOnlineStatus);
            window.addEventListener('offline', updateOnlineStatus);
            
            // Service Worker –¥–ª—è PWA
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/service-worker.js').then(registration => {
                        console.log('ServiceWorker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', registration.scope);
                    }).catch(error => {
                        console.log('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ServiceWorker:', error);
                    });
                });
            }
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>